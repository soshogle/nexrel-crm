<?php
// Exit if accessed directly
if (!defined('ABSPATH')) {
	exit;
}

if (!class_exists('I13_WooCommerce_Settings_Page')) :

	class I13_WooCommerce_Settings_Page extends WC_Settings_Page {

		// Your class and your code / logic

		public function __construct() {

			$this->id = 'i13_woo_recaptcha';
			$this->label = __('reCaptcha', 'recaptcha-for-woocommerce');

			add_filter('woocommerce_settings_tabs_array', array($this, 'add_settings_page'), 20);
			add_action('woocommerce_settings_' . $this->id, array($this, 'output'));
			add_action('woocommerce_settings_save_' . $this->id, array($this, 'save'));

			// only add this if you need to add sections for your settings tab
			add_action('woocommerce_sections_' . $this->id, array($this, 'output_sections'));
			add_action('woocommerce_admin_field_custom_type', array($this, 'output_custom_type'), 10, 1);
			add_action('woocommerce_admin_field_custom_type_turnstile', array($this, 'output_custom_type_turnstile'), 10, 1);
			add_action('woocommerce_admin_field_custom_type_text', array($this, 'output_custom_type_text'), 10, 1);
			add_action('woocommerce_admin_field_custom_type_number', array($this, 'output_custom_type_number'), 10, 1);
		}

		public function output_custom_type_number($value) {
			$option_value = $value['value'];
			?>
			<tr valign="top">
				<th scope="row" class="titledesc">
					<label for="<?php echo esc_attr($value['id']); ?>"><?php echo esc_html($value['title']); ?> </label>
				</th>
				<td class="forminp forminp-<?php echo esc_attr(sanitize_title($value['type'])); ?>">
					<input
						name="<?php echo esc_attr($value['id']); ?>"
						id="<?php echo esc_attr($value['id']); ?>"
						type="number"
						style="<?php echo esc_attr($value['css']); ?>"
						value="<?php echo esc_attr($option_value); ?>"
						class="<?php echo esc_attr($value['class']); ?>" 
						step="0.1"
						placeholder="<?php echo esc_attr($value['placeholder']); ?>"
						min="0"
						max="1"
						/><?php echo esc_html($value['suffix']); ?> 
					<p class="description"><?php echo esc_html(__('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce')); ?></p>
				</td>
			</tr>

			<?php
		}

		public function output_custom_type_text($value) {
			?>
			<tr valign="top">
				<th scope="row" class="titledesc" style="padding-top:0px;padding-bottom: 0px">
					&nbsp;
				</th>
				<td class="forminp forminp-text" style="padding-top:0px;padding-bottom: 0px">
					<?php echo '<b>' . esc_html(__('Note :- ', 'recaptcha-for-woocommerce')) . '</b>' . esc_html($value['desc']); ?>
				</td>
			</tr>

			<?php
		}

		public function output_custom_type_turnstile($value) {
			// you can output the custom type in any format you'd like
			?>
						 <tr valign="top">
							<th scope="row" class="titledesc" style="padding-top:0px;padding-bottom: 0px">
									&nbsp;
							</th>
							<td class="forminp forminp-text" style="padding-top:0px;padding-bottom: 0px">
								<script type="text/javascript">
									
									jQuery(document).on('ready', function(){

										 var radioValue = jQuery("input[name='i13_turnstile_version']:checked").val();
										 if(radioValue=='v2'){
											   changeVisbility(radioValue);
										 }
										 else{

											 changeVisbility(radioValue);
										 }

									  jQuery( "input[name='i13_turnstile_version']" ).on( "click", function() {

											var radioValue = jQuery(this).val();
											changeVisbility(radioValue);
																						if(radioValue=="v3"){
																								alert("<?php echo esc_html( __( 'Turnstile hidden captcha does not show any challenge to solve etc. Hidden mode that works invisibly in the background, using JavaScript challenges and user behavior analysis to verify humans vs. bots, reducing friction for legitimate users while stopping spam without constant visual puzzles.', 'recaptcha-for-woocommerce' ) ); ?>");
																						}

									  });

									  function changeVisbility(radioValue){


											if(radioValue=='v2'){
												
												jQuery('label[for="wc_settings_tab_turnstile_site_key_v3"]').parent().parent().hide();
												jQuery('label[for="wc_settings_tab_turnstile_site_key"]').parent().parent().show();
												
												jQuery('label[for="wc_settings_tab_turnstile_secret_key"]').parent().parent().show();
												jQuery('label[for="wc_settings_tab_turnstile_secret_key_v3"]').parent().parent().hide();
												
												jQuery('label[for="wc_settings_tab_turnstile_error_msg_captcha_blank"]').parent().parent().show();
												jQuery('label[for="wc_settings_tab_turnstile_error_msg_captcha_no_response"]').parent().parent().show();
												jQuery('label[for="wc_settings_tab_turnstile_error_msg_captcha_invalid"]').parent().parent().show();
												jQuery('label[for="i13_turnstile_error_msg_v3_invalid_captcha"]').parent().parent().hide();
												jQuery('label[for="i13_turnstile_error_msg_captcha_blank_v3"]').parent().parent().hide();
												jQuery('label[for="i13_turnstile_error_msg_captcha_no_response_v3"]').parent().parent().hide();
												jQuery('label[for="i13_turnstile_no_conflict_v3"]').parent().parent().parent().hide();
												jQuery('label[for="i13_turnstile_no_conflict"]').parent().parent().parent().show();
												jQuery('label[for="i13_turnstile_v2_lang"]').parent().parent().show();
												jQuery('label[for="i13_turnstile_use_both_recaptcha"]').parent().parent().parent().hide();
											}
											else{

																								jQuery('label[for="i13_turnstile_use_both_recaptcha"]').parent().parent().parent().show();
												jQuery('label[for="wc_settings_tab_turnstile_site_key_v3"]').parent().parent().show();
												jQuery('label[for="wc_settings_tab_turnstile_site_key"]').parent().parent().hide();
												
												jQuery('label[for="wc_settings_tab_turnstile_secret_key"]').parent().parent().hide();
												jQuery('label[for="wc_settings_tab_turnstile_secret_key_v3"]').parent().parent().show();
												
												jQuery('label[for="wc_settings_tab_turnstile_error_msg_captcha_blank"]').parent().parent().hide();
												jQuery('label[for="wc_settings_tab_turnstile_error_msg_captcha_no_response"]').parent().parent().hide();
												jQuery('label[for="wc_settings_tab_turnstile_error_msg_captcha_invalid"]').parent().parent().hide();
												jQuery('label[for="i13_turnstile_error_msg_v3_invalid_captcha"]').parent().parent().show();
												jQuery('label[for="i13_turnstile_error_msg_captcha_blank_v3"]').parent().parent().show();
												jQuery('label[for="i13_turnstile_error_msg_captcha_no_response_v3"]').parent().parent().show();
												
												jQuery('label[for="i13_turnstile_no_conflict_v3"]').parent().parent().parent().show();
												jQuery('label[for="i13_turnstile_no_conflict"]').parent().parent().parent().hide();
												jQuery('label[for="i13_turnstile_v2_lang"]').parent().parent().hide();
																								
																								
																								
											}

									  }
																		  
																		  
																		  jQuery('#i13_turnstile_use_both_recaptcha').click(function() {
																			  
																			  if (jQuery('#i13_turnstile_use_both_recaptcha').is(':checked')) {
																				  
																				 alert('<?php echo esc_html(__( 'Note:- To use checkbox captcha along with hidden mode captcha , Please set captcha mode first and set all options as you need and then set hidden mode captcha', 'recaptcha-for-woocommerce' )); ?>');
																				 
																				}
																				 
																		   });
																		  
																			 jQuery('#i13_turnstile_use_both_recaptcha').change(function() {
																					if(this.checked) {
																						
																						
																						jQuery('label[for="wc_settings_tab_turnstile_site_key"]').parent().parent().show();
																						jQuery('label[for="wc_settings_tab_turnstile_secret_key"]').parent().parent().show();
																						jQuery('label[for="i13_turnstile_v2_timeout"]').parent().parent().show();
																						

																						
																					}
																					else{
																						
																						  
																						jQuery('label[for="wc_settings_tab_turnstile_site_key"]').parent().parent().hide();
																						jQuery('label[for="wc_settings_tab_turnstile_secret_key"]').parent().parent().hide();
																						jQuery('label[for="i13_turnstile_v2_timeout"]').parent().parent().hide();
																					  
																						
																					}
																				   
																				});
																				
																				
																				if(jQuery('input[name="i13_turnstile_version"]:checked').val()=='v3'){
																					
																					
																					jQuery('#i13_turnstile_use_both_recaptcha').trigger('change');
																					
																				}

									})
																		
											
																		  document.addEventListener('DOMContentLoaded', function () {
																				const select = document.querySelector('.i13-provider-select');
																				if (!select)
																					return;

																				select.value = 'turnstile';
																				select.addEventListener('change', function () {
																					let provider = this.value;
																					let url = new URL(window.location.href);
																					url.searchParams.set('provider', provider);
																					window.location.href = url.toString();
																				});
																			});               

								</script>   
								
							</td>
						</tr>
						
			<?php
			
		}
		public function output_custom_type($value) {
			// you can output the custom type in any format you'd like
			?>
			<tr valign="top">
				<th scope="row" class="titledesc" style="padding-top:0px;padding-bottom: 0px">
					&nbsp;
				</th>
				<td class="forminp forminp-text" style="padding-top:0px;padding-bottom: 0px">
					<script type="text/javascript">

						jQuery(document).on('ready', function () {

							var isRecaptcha_enterprise = jQuery("input[name='i13_recapcha_use_enterprise_recaptcha']").prop('checked');

							var radioValue = jQuery("input[name='i13_recapcha_version']:checked").val();
							if (radioValue == 'v2') {
								changeVisbility(radioValue, isRecaptcha_enterprise);
							} else {

								changeVisbility(radioValue, isRecaptcha_enterprise);
							}

							jQuery("input[name='i13_recapcha_version']").on("click", function () {

								var radioValue = jQuery(this).val();
								isRecaptcha_enterprise_ = jQuery("input[name='i13_recapcha_use_enterprise_recaptcha']").prop('checked');
								changeVisbility(radioValue, isRecaptcha_enterprise_);
								if (radioValue == "v3") {
									alert("<?php echo esc_html(__('Recaptcha V3 does not show any challenge like I am not robot etc. ReCaptcha V3 uses a behind-the-scenes scoring system to detect abusive traffic, and lets you decide the minimum passing score. Please note that there is no user interaction shown in reRecapcha V3 meaning that no recaptcha challenge is shown to solve.', 'recaptcha-for-woocommerce')); ?>");
								}



							});

							jQuery("input[name='i13_recapcha_use_enterprise_recaptcha']").on("click", function () {


								isRecaptcha_enterprise_ = jQuery("input[name='i13_recapcha_use_enterprise_recaptcha']").prop('checked');

								radioValue_ = jQuery("input[name='i13_recapcha_version']:checked").val();

								changeVisbility(radioValue_, isRecaptcha_enterprise_);

							});
							jQuery("input[name='i13_recapcha_use_both_recaptcha']").on("click", function () {


								isRecaptcha_enterprise_ = jQuery("input[name='i13_recapcha_use_enterprise_recaptcha']").prop('checked');

								radioValue_ = jQuery("input[name='i13_recapcha_version']:checked").val();

								changeVisbility(radioValue_, isRecaptcha_enterprise_);

							});

							function changeVisbility(radioValue, isRecaptcha_enterprise) {

								if (radioValue == 'v2' && isRecaptcha_enterprise == false) {

									jQuery("#enterprise_v2").hide();
									jQuery("#classic_v2").show();

									jQuery("#i13_guide_classic").show();
									jQuery("#i13_guide_enterprise").hide();
									jQuery('label[for="wc_settings_tab_recapcha_site_key_v3"]').parent().parent().hide();
									jQuery('label[for="wc_settings_tab_recapcha_site_key"]').parent().parent().show();

									jQuery('label[for="wc_settings_tab_recapcha_secret_key"]').parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_secret_key_v3"]').parent().parent().hide();

									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_blank"]').parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_no_response"]').parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_invalid"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_error_msg_v3_invalid_captcha"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_error_msg_captcha_blank_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_msg_token_generation"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_error_msg_captcha_no_response_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_no_conflict_v3"]').parent().parent().parent().hide();
									jQuery('label[for="i13_recapcha_no_conflict"]').parent().parent().parent().show();
									jQuery('label[for="i13_recapcha_v2_lang"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_use_both_recaptcha"]').parent().parent().parent().hide();
									jQuery('label[for="i13_recapcha_google_cloud_api_key"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_google_cloud_project_id"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_google_cloud_api_key_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_google_cloud_project_id_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_v2_timeout"]').parent().parent().hide();
								} else if (radioValue == 'v2' && isRecaptcha_enterprise == true) {

									jQuery("#classic_v2").hide();
									jQuery("#enterprise_v2").show();

									jQuery("#i13_guide_classic").hide();
									jQuery("#i13_guide_enterprise").show();

									jQuery('label[for="wc_settings_tab_recapcha_site_key_v3"]').parent().parent().hide();
									jQuery('label[for="wc_settings_tab_recapcha_site_key"]').parent().parent().show();

									jQuery('label[for="wc_settings_tab_recapcha_secret_key"]').parent().parent().hide();
									jQuery('label[for="wc_settings_tab_recapcha_secret_key_v3"]').parent().parent().hide();

									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_blank"]').parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_no_response"]').parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_invalid"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_error_msg_v3_invalid_captcha"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_error_msg_captcha_blank_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_msg_token_generation"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_error_msg_captcha_no_response_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_no_conflict_v3"]').parent().parent().parent().hide();
									jQuery('label[for="i13_recapcha_no_conflict"]').parent().parent().parent().show();
									jQuery('label[for="i13_recapcha_v2_lang"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_use_both_recaptcha"]').parent().parent().parent().hide();
									jQuery('label[for="i13_recapcha_google_cloud_api_key"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_google_cloud_project_id"]').parent().parent().show();

									jQuery('label[for="i13_recapcha_google_cloud_api_key_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_google_cloud_project_id_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_v2_timeout"]').parent().parent().hide();




								} else if (radioValue == 'v3' && isRecaptcha_enterprise == false) {

									jQuery("#classic_v3").show();
									jQuery("#enterprise_v3").hide();

									jQuery("#i13_guide_classic").show();
									jQuery("#i13_guide_enterprise").hide();

									jQuery('label[for="i13_recapcha_use_both_recaptcha"]').parent().parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_site_key_v3"]').parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_site_key"]').parent().parent().hide();

									jQuery('label[for="wc_settings_tab_recapcha_secret_key"]').parent().parent().hide();
									jQuery('label[for="wc_settings_tab_recapcha_secret_key_v3"]').parent().parent().show();

									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_blank"]').parent().parent().hide();
									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_no_response"]').parent().parent().hide();
									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_invalid"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_error_msg_v3_invalid_captcha"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_error_msg_captcha_blank_v3"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_msg_token_generation"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_error_msg_captcha_no_response_v3"]').parent().parent().show();

									jQuery('label[for="i13_recapcha_no_conflict_v3"]').parent().parent().parent().show();
									jQuery('label[for="i13_recapcha_no_conflict"]').parent().parent().parent().hide();
									jQuery('label[for="i13_recapcha_v2_lang"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_google_cloud_api_key"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_google_cloud_project_id"]').parent().parent().hide();

									jQuery('label[for="i13_recapcha_google_cloud_api_key_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_google_cloud_project_id_v3"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_v2_timeout"]').parent().parent().hide();

									isRecaptcha_both = jQuery("input[name='i13_recapcha_use_both_recaptcha']").prop('checked');
									if (isRecaptcha_both == true) {

										jQuery("#classic_v2").show();
										jQuery("#enterprise_v2").hide();


									}



								} else if (radioValue == 'v3' && isRecaptcha_enterprise == true) {

									jQuery("#classic_v3").hide();
									jQuery("#enterprise_v3").show();

									jQuery("#i13_guide_classic").hide();
									jQuery("#i13_guide_enterprise").show();

									jQuery('label[for="i13_recapcha_use_both_recaptcha"]').parent().parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_site_key_v3"]').parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_site_key"]').parent().parent().hide();

									jQuery('label[for="wc_settings_tab_recapcha_secret_key"]').parent().parent().hide();
									jQuery('label[for="wc_settings_tab_recapcha_secret_key_v3"]').parent().parent().hide();

									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_blank"]').parent().parent().hide();
									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_no_response"]').parent().parent().hide();
									jQuery('label[for="wc_settings_tab_recapcha_error_msg_captcha_invalid"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_error_msg_v3_invalid_captcha"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_error_msg_captcha_blank_v3"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_msg_token_generation"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_error_msg_captcha_no_response_v3"]').parent().parent().show();

									jQuery('label[for="i13_recapcha_no_conflict_v3"]').parent().parent().parent().show();
									jQuery('label[for="i13_recapcha_no_conflict"]').parent().parent().parent().hide();
									jQuery('label[for="i13_recapcha_v2_lang"]').parent().parent().hide();
									jQuery('label[for="i13_recapcha_v2_timeout"]').parent().parent().hide();


									isRecaptcha_both = jQuery("input[name='i13_recapcha_use_both_recaptcha']").prop('checked');
									if (isRecaptcha_both == true) {

										jQuery('label[for="i13_recapcha_google_cloud_api_key"]').parent().parent().show();
										jQuery('label[for="i13_recapcha_google_cloud_project_id"]').parent().parent().show();
										jQuery('label[for="i13_recapcha_v2_timeout"]').parent().parent().show();

										jQuery("#classic_v2").hide();
										jQuery("#enterprise_v2").show();

									} else {
										jQuery('label[for="i13_recapcha_google_cloud_api_key"]').parent().parent().hide();
										jQuery('label[for="i13_recapcha_google_cloud_project_id"]').parent().parent().hide();
										jQuery('label[for="i13_recapcha_v2_timeout"]').parent().parent().hide();


									}

									jQuery('label[for="i13_recapcha_google_cloud_api_key_v3"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_google_cloud_project_id_v3"]').parent().parent().show();



								}

								setTimeout(function () {

									jQuery('#i13_recapcha_use_enterprise_recaptcha').trigger('change');

									setTimeout(function () {
										jQuery('#i13_recapcha_use_both_recaptcha').trigger('change');

									}, 50);

								}, 100);



							}


							jQuery('#i13_recapcha_use_both_recaptcha').click(function () {

								if (jQuery('#i13_recapcha_use_both_recaptcha').is(':checked')) {

									alert('<?php echo esc_html(__('Note:- To use reCaptcha V2 along with reCaptcha V3, Please set reCaptcha V2 first and set all options as you need and then set reCaptcha V3', 'recaptcha-for-woocommerce')); ?>');

								}

							});

							jQuery('#i13_recapcha_use_both_recaptcha').change(function () {

								radioValue_ = jQuery("input[name='i13_recapcha_version']:checked").val();
								isRecaptcha_enterprise_ = jQuery("input[name='i13_recapcha_use_enterprise_recaptcha']").prop('checked');
								if (this.checked && radioValue_ == 'v3') {


									jQuery('label[for="wc_settings_tab_recapcha_site_key"]').parent().parent().show();
									jQuery('label[for="wc_settings_tab_recapcha_secret_key"]').parent().parent().show();
									jQuery('label[for="i13_recapcha_v2_timeout"]').parent().parent().show();
									if (isRecaptcha_enterprise_ == true) {
										jQuery('label[for="wc_settings_tab_recapcha_site_key"]').parent().parent().show();
										jQuery('label[for="wc_settings_tab_recapcha_secret_key"]').parent().parent().hide();
										jQuery('label[for="i13_recapcha_google_cloud_api_key"]').parent().parent().show();
										jQuery('label[for="i13_recapcha_google_cloud_project_id"]').parent().parent().show();

									}


								}


							});


							if (jQuery('input[name="i13_recapcha_version"]:checked').val() == 'v3') {


								jQuery('#i13_recapcha_use_both_recaptcha').trigger('change');

							}

						})


						document.addEventListener('DOMContentLoaded', function () {
							const select = document.querySelector('.i13-provider-select');
							if (!select)
								return;

							select.value = 'google';
							select.addEventListener('change', function () {
								let provider = this.value;
								let url = new URL(window.location.href);
								url.searchParams.set('provider', provider);
								window.location.href = url.toString();
							});
						});

					</script>   

				</td>
			</tr>

			<?php
		}

		public function get_sections() {

			$sections = array(
				'' => __('General Settings', 'recaptcha-for-woocommerce'),
				'signup' => __('Woo Registration Captcha', 'recaptcha-for-woocommerce'),
				'login' => __('Woo Login Captcha', 'recaptcha-for-woocommerce'),
				'forgotpassword' => __('Woo Lost Password Captcha', 'recaptcha-for-woocommerce'),
				'guestcheckout' => __('Woo Checkout Captcha', 'recaptcha-for-woocommerce'),
				'add_payment_method' => __('Woo Add Payment Method Captcha', 'recaptcha-for-woocommerce'),
				'woo_review' => __('Woo Product Review Form Captcha', 'recaptcha-for-woocommerce'),
				'woo_order_tracking' => __('Woo Order Tracking', 'recaptcha-for-woocommerce'),
				'woo_comments' => __('Woo Post Comment Form Captcha', 'recaptcha-for-woocommerce'),
				'wp_login' => __('WP Login Captcha', 'recaptcha-for-woocommerce'),
				'wp_register' => __('WP Registration Captcha', 'recaptcha-for-woocommerce'),
				'wp_lostpassword' => __('WP Lost Password Captcha', 'recaptcha-for-woocommerce'),
				'jetpack_form' => __('Jetpack Forms', 'recaptcha-for-woocommerce'),
			);

			return apply_filters('woocommerce_get_sections_' . $this->id, $sections);
		}

		public function get_settings($current_section = '') {

			$provider = isset($_GET['provider']) ? sanitize_text_field($_GET['provider']) : '';
			if ('' == $provider) {

				$provider = get_option('i13_captcha_provider', 'google');
			}
			$i13_recaptcha_fresh_install = get_option('i13_recaptcha_fresh_install');
			if ('signup' == $current_section) {

				/**
				 * Filter Plugin Section 2 Settings
				 *
				 * @since 1.0.0
				 * @param array $settings Array of the plugin settings
				 */
				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {
					
					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				if ('v2' == strtolower($reCapcha_version)) {

					$settings = apply_filters(
							'i13woocomm_signup',
							array(
								'section_title_recpacha_on_signup' => array(
									'name' => __('Recaptcha On Registration Page', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_signup',
								),
								'i13_recapcha_enable_on_signup' => array(
									'name' => __('Enable Recaptcha on Signup', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_signup',
								),
								'i13_recapcha_signup_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_signup_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_signup' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_signup',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_signup_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_signup_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_signup_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_signup_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_woo_signup' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_woo_signup',
								),
								'i13_recapcha_using_ajax_registration_v2' => array(
									'name' => __('Using ajax signup popup?', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_using_ajax_registration_v2',
									'desc' => __('If your theme has ajax signup modal box', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_using_buddy_press' => array(
									'name' => __('Using Buddy Press signup?', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_using_buddy_press',
									'desc' => __('If your are using buddy press signup', 'recaptcha-for-woocommerce'),
								),
								'i13_block_rest_registrations' => array(
									'name' => __('Block REST API Registrations', 'recaptcha-for-woocommerce'),
									'desc' => __('Useful when you see lots of fake Registrations.', 'recaptcha-for-woocommerce'),
									'id' => 'i13_block_rest_registrations',
									'css' => 'min-width:150px;',
									'std' => 'left',
									'class' => 'wc-enhanced-select',
									'custom_attributes' => array(
										'data-placeholder' => __('Select API Versions to Block', 'woocommerce'),
									),
									'type' => 'multiselect',
									'options' => array(
										'v1' => __('Block V1 Registration endpoint', 'recaptcha-for-woocommerce'),
										'v2' => __('Block V2 Registration endpoint', 'recaptcha-for-woocommerce'),
										'v3' => __('Block V3 Registration endpoint', 'recaptcha-for-woocommerce'),
									),
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_signup',
								),
							)
					);
				} else {
  
					 $woo_reg= array(
								'section_title_recpacha_on_signup' => array(
									'name' => __('Recaptcha On Registration Page', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_signup',
								),
								'i13_recapcha_enable_on_signup' => array(
									'name' => __('Enable Recaptcha on Signup', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_signup',
								),
								'i13_recapcha_signup_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_signup_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_signup_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_signup_action_v3',
									'default' => 'signup',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
								/* 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_signup' => array(
								  'name' => __( 'Disable on the fly reCAPTCHA v3 token generation', 'recaptcha-for-woocommerce' ),
								  'type' => 'checkbox',
								  'id' => 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_signup',
								  'desc' => __( 'Use only when there is problem with other plugin that use submit button. For example error like "Google reCAPTCHA token is missing" ', 'recaptcha-for-woocommerce' ),
								  'default' => ( 'yes' == $i13_recaptcha_fresh_install ) ? 'yes' : 'no',
								  ), */
								'i13_recapcha_using_ajax_registration_v3' => array(
									'name' => __('Using ajax signup popup?', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_using_ajax_registration_v3',
									'desc' => __('If your theme has ajax signup modal box', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_using_buddy_press' => array(
									'name' => __('Using Buddy Press signup?', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_using_buddy_press',
									'desc' => __('If your are using buddy press signup', 'recaptcha-for-woocommerce'),
								),
								'i13_block_rest_registrations' => array(
									'name' => __('Block REST API Registrations', 'recaptcha-for-woocommerce'),
									'desc' => __('Useful when you see lots of fake Registrations.', 'recaptcha-for-woocommerce'),
									'id' => 'i13_block_rest_registrations',
									'css' => 'min-width:150px;',
									'std' => 'left',
									'class' => 'wc-enhanced-select',
									'custom_attributes' => array(
										'data-placeholder' => __('Select API Versions to Block', 'woocommerce'),
									),
									'type' => 'multiselect',
									'options' => array(
										'v1' => __('Block V1 Registration endpoint', 'recaptcha-for-woocommerce'),
										'v2' => __('Block V2 Registration endpoint', 'recaptcha-for-woocommerce'),
										'v3' => __('Block V3 Registration endpoint', 'recaptcha-for-woocommerce'),
									),
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_signup',
								),
							);
					 if ('google'!==$provider) {
						 
						 unset($woo_reg['i13_recapcha_signup_score_threshold_v3']);
					 }       
					
					 if ('turnstile'==$provider) {
						
						 $woo_reg['i13_recapcha_signup_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						 $woo_reg['i13_recapcha_signup_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					 } 
					
					$settings = apply_filters(
							'i13woocomm_signup',
							$woo_reg
					);
				}
			} else if ('login' == $current_section) {

				
				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {

					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				
				if ('v2' == strtolower($reCapcha_version)) {

					$settings = apply_filters(
							'i13woocomm_login_settings',
							array(
								'section_title_recpacha_on_login' => array(
									'name' => __('Recaptcha On Login Page', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_login',
								),
								'i13_recapcha_enable_on_login' => array(
									'name' => __('Enable Recaptcha on Login', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_login',
								),
								'i13_recapcha_login_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_login_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_login' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_login',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_login_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_login_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_login_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_login_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_woo_login' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_woo_login',
								),
								'i13_recapcha_custom_wp_login_form_login' => array(
									'name' => __('Have custom wp login form', 'recaptcha-for-woocommerce'),
									'desc' => __('Using custom login form with using wp_login_form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_custom_wp_login_form_login',
								),
								'i13_recapcha_using_ajax_login_v2' => array(
									'name' => __('Using ajax login popup?', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_using_ajax_login_v2',
									'desc' => __('If your theme has ajax login modal box', 'recaptcha-for-woocommerce'),
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_login',
								),
							)
					);
				} else {

					
					$woo_login=array(
								'section_title_recpacha_on_login' => array(
									'name' => __('Recaptcha On Login Page', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_login',
								),
								'i13_recapcha_enable_on_login' => array(
									'name' => __('Enable Recaptcha on Login', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_login',
								),
								'i13_recapcha_login_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_login_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_login_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_login_action_v3',
									'default' => 'login',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
								'  i13_recapcha__v3_custom_wp_login_form_login' => array(
									'name' => __('Have custom wp login form', 'recaptcha-for-woocommerce'),
									'desc' => __('Using custom login form with using wp_login_form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha__v3_custom_wp_login_form_login',
								),
								/* 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_login' => array(
								  'name' => __( 'Disable on the fly reCAPTCHA v3 token generation', 'recaptcha-for-woocommerce' ),
								  'type' => 'checkbox',
								  'id' => 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_login',
								  'desc' => __( 'Use only when there is problem with other plugin that use submit button. For example error like "Google reCAPTCHA token is missing" ', 'recaptcha-for-woocommerce' ),
								  'default' => ( 'yes' == $i13_recaptcha_fresh_install ) ? 'yes' : 'no',
								  ), */
								'i13_recapcha_using_ajax_login_v3' => array(
									'name' => __('Using ajax login popup?', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_using_ajax_login_v3',
									'desc' => __('If your theme has ajax login modal box', 'recaptcha-for-woocommerce'),
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_login',
								),
							);
					
					if ('google'!==$provider) {
						 
						unset($woo_login['i13_recapcha_login_score_threshold_v3']);
					}       
					
					if ('turnstile'==$provider) {
						
						$woo_login['i13_recapcha_login_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						$woo_login['i13_recapcha_login_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					} 
					
					$settings = apply_filters(
							'i13woocomm_login_settings',
							$woo_login
							
					);
				}
			} else if ('forgotpassword' == $current_section) {

				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {

					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				
				if ('v2' == strtolower($reCapcha_version)) {
					$settings = apply_filters(
							'i13woocomm_forgotpassword_settings',
							array(
								'section_title_recpacha_on_lost_password' => array(
									'name' => __('Recaptcha On Lost Password Page', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_lostpassword',
								),
								'i13_recapcha_enable_on_lostpassword' => array(
									'name' => __('Enable Recaptcha on Lost Password', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_lostpassword',
								),
								'i13_recapcha_lostpassword_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_lostpassword_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_lostpassword' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_lostpassword',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_lostpassword_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_lostpassword_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_lostpassword_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_lostpassword_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_woo_lostpassword' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_woo_lostpassword',
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_lostpassword',
								),
							)
					);
				} else {

					$fogot_pass=array(
								'section_title_recpacha_on_lost_password' => array(
									'name' => __('Recaptcha On Lost Password Page', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_lostpassword',
								),
								'i13_recapcha_enable_on_lostpassword' => array(
									'name' => __('Enable Recaptcha on Lost Password', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_lostpassword',
								),
								'i13_recapcha_lostpassword_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_lostpassword_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_lostpassword_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_lostpassword_action_v3',
									'default' => 'forgot_password',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
								/* 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_fpass' => array(
								  'name' => __( 'Disable on the fly reCAPTCHA v3 token generation', 'recaptcha-for-woocommerce' ),
								  'type' => 'checkbox',
								  'id' => 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_fpass',
								  'desc' => __( 'Use only when there is problem with other plugin that use submit button. For example error like "Google reCAPTCHA token is missing" ', 'recaptcha-for-woocommerce' ),
								  'default' => ( 'yes' == $i13_recaptcha_fresh_install ) ? 'yes' : 'no',
								  ), */
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_lostpassword',
								),
							);
					
					if ('google'!==$provider) {
						 
						unset($fogot_pass['i13_recapcha_lostpassword_score_threshold_v3']);
					}       
					
					if ('turnstile'==$provider) {
						
						$fogot_pass['i13_recapcha_lostpassword_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						$fogot_pass['i13_recapcha_lostpassword_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					} 
					
					$settings = apply_filters(
							'i13woocomm_forgotpassword_settings',
							$fogot_pass
							
					);
				}
			} else if ('guestcheckout' == $current_section) {

				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {

					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				
				if ('v2' == strtolower($reCapcha_version)) {
					$settings = apply_filters(
							'i13woocomm_guestcheckout_settings',
							array(
								'section_title_recpacha_on_guestcheckout' => array(
									'name' => __('Recaptcha on Checkout', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_guestcheckout',
								),
								'i13_recapcha_enable_on_guestcheckout' => array(
									'name' => __('Enable Recaptcha on Guest Checkout', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_guestcheckout',
								),
								'i13_recapcha_enable_on_logincheckout' => array(
									'name' => __('Enable Recaptcha on Login Checkout', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_logincheckout',
								),
								'i13_recapcha_block' => array(
									'name' => __('Enable Captcha Block', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_block',
									'desc' => __('When checked, It enable captcha for checkout block. If you are not using classic checkout and using checkout block. This option enable captcha for checkout block.', 'recaptcha-for-woocommerce')
								),
								'i13_recapcha_enable_on_payfororder' => array(
									'name' => __('Enable Recaptcha on Pay For Order', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_payfororder',
									'desc' => __('WooCommerce allow failed order to pay again. In this case captcha must be needed to prevent fraud', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_guestcheckout_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_guestcheckout_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_checkout' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_checkout',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_checkout_timeout' => array(
									'name' => __('Recaptcha Validity', 'recaptcha-for-woocommerce'),
									'type' => 'number',
									'id' => 'i13_recapcha_checkout_timeout',
									'default' => '3',
									'desc' => __('Some payment processor needs more time to process an order. So captcha will valid for a given number of minutes once reCaptcha is validate. 0 means require validation on each request. Default value is 3 minute will used if you leave blank.', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_guestcheckout_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_guestcheckout_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_guestcheckout_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_guestcheckout_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_guestcheckout_refresh' => array(
									'name' => __('Recaptcha Refresh Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_guestcheckout_refresh',
									'default' => 'Refresh Captcha',
								),
								'i13_recapcha_disable_submitbtn_guestcheckout' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate for guest checkout.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_guestcheckout',
								),
								'i13_recapcha_disable_submitbtn_logincheckout' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate for login checkout.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_logincheckout',
								),
								'i13_recapcha_disable_submitbtn_payfororder' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate for pay for order.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_payfororder',
								),
								'i13_recapcha_guest_recpacha_refersh_on_error' => array(
									'name' => __('Refresh captcha on guest checkout error', 'recaptcha-for-woocommerce'),
									'desc' => __('Refresh captcha on guest checkout error', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_guest_recpacha_refersh_on_error',
								),
								'i13_recapcha_login_recpacha_refersh_on_error' => array(
									'name' => __('Refresh captcha on login checkout error', 'recaptcha-for-woocommerce'),
									'desc' => __('Refresh captcha on login checkout error', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_login_recpacha_refersh_on_error',
								),
								'i13_recaptcha_login_recpacha_for_req_btn' => array(
									'name' => __('Enable captcha for express checkout buttons on product page', 'recaptcha-for-woocommerce'),
									'desc' => __('If you have enabled express checkout buttons for checkout directly from product page you can enable captcha. For example Google Pay, Apple Pay available in stripe.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recaptcha_login_recpacha_for_req_btn',
								),
								'i13_recaptcha_login_recpacha_for_req_btn_cart_page' => array(
									'name' => __('Enable captcha for express checkout buttons on cart page', 'recaptcha-for-woocommerce'),
									'desc' => __('If you have enabled express checkout buttons for checkout directly from cart page you can enable captcha. For example Google Pay, Apple Pay available in stripe.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recaptcha_login_recpacha_for_req_btn_cart_page',
								),
								'i13_recaptcha_block_unknown_orgin_orders' => array(
									'name' => __('Block orders from “unknown” origin', 'recaptcha-for-woocommerce'),
									'desc' => __('This is useful when there is a carding attack. When order management shows “unknown” as the origin of many failed orders, you can use this to block.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recaptcha_block_unknown_orgin_orders',
								),
								'i13_recapcha_wc_block_checkout_api_old' => array(
									'name' => __('Block REST API Checkout endpoint', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_wc_block_checkout_api_old',
									'desc' => __('Attackers are using REST API to create BOT orders. You can check the mark to block the REST Checkout endpoint. Please note that if your site needs orders via the API then please do not use this option.', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_wc_block_checkout_api_v1' => array(
									'name' => __('Block REST API Checkout endpoint V1 (Checkout Block)', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_wc_block_checkout_api_v1',
									'desc' => __('Attackers are using REST API to create BOT orders. You can check the mark to block the REST Checkout endpoint. Please note that if your site uses latest checkout block feature of WooCommerce then please do not use this option.', 'recaptcha-for-woocommerce'),
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_guestcheckout',
								),
							)
					);
				} else {

					
					$arr_checkout=array(
								'section_title_recpacha_on_guestcheckout' => array(
									'name' => __('Recaptcha on Checkout', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_guestcheckout',
								),
								'i13_recapcha_enable_on_guestcheckout' => array(
									'name' => __('Enable Recaptcha on Guest Checkout', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_guestcheckout',
								),
								'i13_recapcha_enable_on_logincheckout' => array(
									'name' => __('Enable Recaptcha on Login Checkout', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_logincheckout',
								),
								'i13_recapcha_block' => array(
									'name' => __('Enable Captcha Block', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_block',
									'desc' => __('When checked, It enable captcha for checkout block. If you are not using classic checkout and using checkout block. This option enable captcha for checkout block', 'recaptcha-for-woocommerce')
								),
								'i13_recapcha_enable_on_payfororder' => array(
									'name' => __('Enable Recaptcha on Pay For Order', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_payfororder',
									'desc' => __('WooCommerce allow failed order to pay again. In this case captcha must be needed to prevent fraud', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_checkout_timeout' => array(
									'name' => __('Recaptcha Validity', 'recaptcha-for-woocommerce'),
									'type' => 'number',
									'id' => 'i13_recapcha_checkout_timeout',
									'default' => '3',
									'desc' => __('Some payment processor needs more time to process an order. So captcha will valid for a given number of minutes once reCaptcha is validate. 0 means require validation on each request. Default value is 3 minute will used if you leave blank.', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_checkout_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_checkout_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_checkout_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_checkout_action_v3',
									'default' => 'checkout',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
								/* 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_checkout' => array(
								  'name' => __( 'Disable on the fly reCAPTCHA v3 token generation', 'recaptcha-for-woocommerce' ),
								  'type' => 'checkbox',
								  'id' => 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_checkout',
								  'desc' => __( 'Use only when there is problem with other plugin that use submit button. For example error like "Google reCAPTCHA token is missing" ', 'recaptcha-for-woocommerce' ),
								  'default' => ( 'yes' == $i13_recaptcha_fresh_install ) ? 'yes' : 'no',
								  ), */
								'i13_recaptcha_v3_login_recpacha_for_req_btn' => array(
									'name' => __('Enable captcha for express checkout buttons on product page', 'recaptcha-for-woocommerce'),
									'desc' => __('If you have enabled express checkout buttons for checkout directly from product page you can enable captcha. For example Google Pay, Apple Pay available in stripe.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recaptcha_v3_login_recpacha_for_req_btn',
								),
								'i13_recaptcha_v3_login_recpacha_for_req_btn_cart_page' => array(
									'name' => __('Enable captcha for express checkout buttons on cart page', 'recaptcha-for-woocommerce'),
									'desc' => __('If you have enabled express checkout buttons for checkout directly from cart page you can enable captcha. For example Google Pay, Apple Pay available in stripe.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recaptcha_v3_login_recpacha_for_req_btn_cart_page',
								),
								'i13_recaptcha_block_unknown_orgin_orders' => array(
									'name' => __('Block orders from “unknown” origin', 'recaptcha-for-woocommerce'),
									'desc' => __('This is useful when there is a carding attack. When order management shows “unknown” as the origin of many failed orders, you can use this to block.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recaptcha_block_unknown_orgin_orders',
								),
								'i13_recapcha_wc_block_checkout_api_old' => array(
									'name' => __('Block REST API Checkout endpoint', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_wc_block_checkout_api_old',
									'desc' => __('Attackers are using REST API to create BOT orders. You can check the mark to block the REST Checkout endpoint. Please note that if your site needs orders via the API then please do not use this option.', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_wc_block_checkout_api_v1' => array(
									'name' => __('Block REST API Checkout endpoint V1 (Checkout Block)', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_wc_block_checkout_api_v1',
									'desc' => __('Attackers are using REST API to create BOT orders. You can check the mark to block the REST Checkout endpoint. Please note that if your site uses latest checkout block feature of WooCommerce then please do not use this option.', 'recaptcha-for-woocommerce'),
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_guestcheckout',
								),
							);
					
					
					if ('google'!==$provider) {
						 
						 unset($arr_checkout['i13_recapcha_checkout_score_threshold_v3']);
					}       
					
					if ('turnstile'==$provider) {
						
						$arr_checkout['i13_recapcha_checkout_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						$arr_checkout['i13_recapcha_checkout_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					} 
					
					$settings = apply_filters(
							'i13woocomm_guestcheckout_settings',
							$arr_checkout
					);
				}
			} else if ('wp_login' == $current_section) {

				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {
					
					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				if ('v2' == strtolower($reCapcha_version)) {

					$settings = apply_filters(
							'i13woocomm_wplogin_settings',
							array(
								'section_title_recpacha_on_wplogin' => array(
									'name' => __('Recaptcha On WP Login', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_wplogin',
								),
								'i13_recapcha_enable_on_wplogin' => array(
									'name' => __('Enable Recaptcha on WP Login', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_wplogin',
								),
								'i13_recapcha_wplogin_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_wplogin_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_wplogin' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_wplogin',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_wplogin_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_wplogin_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_wplogin_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_wplogin_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_wp_login' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_wp_login',
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_wplogin',
								),
							)
					);
				} else {

					$arr_wp_login=array(
								'section_title_recpacha_on_wplogin' => array(
									'name' => __('Recaptcha On WP Login', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_wplogin',
								),
								'i13_recapcha_enable_on_wplogin' => array(
									'name' => __('Enable Recaptcha on WP Login', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_wplogin',
								),
								'i13_recapcha_wp_login_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_wp_login_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_wp_login_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_wp_login_action_v3',
									'default' => 'wp_login',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
							 
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_wplogin',
								),
							);
					
					if ('google'!==$provider) {
						 
						unset($arr_wp_login['i13_recapcha_wp_login_score_threshold_v3']);
					}       
					
					if ('turnstile'==$provider) {
						
						$arr_wp_login['i13_recapcha_wp_login_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						$arr_wp_login['i13_recapcha_wp_login_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					} 
					$settings = apply_filters(
							'i13woocomm_wplogin_settings',
							$arr_wp_login
					);
				}
			} else if ('add_payment_method' == $current_section) {

				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {
					
					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				if ('v2' == strtolower($reCapcha_version)) {

					$settings = apply_filters(
							'i13woocomm_addpaymentmethod_settings',
							array(
								'section_title_recpacha_on_addpaymentmethod' => array(
									'name' => __('Recaptcha On Add Payment Method', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_addpaymentmethod',
								),
								'i13_recapcha_enable_on_addpaymentmethod' => array(
									'name' => __('Enable Recaptcha on Add Payment Method', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_addpaymentmethod',
								),
								'i13_recapcha_addpaymentmethod_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_addpaymentmethod_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_addpayment' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_addpayment',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_addpaymentmethod_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_addpaymentmethod_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_addpaymentmethod_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_addpaymentmethod_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_paymentmethod' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_paymentmethod',
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_addpaymentmethod',
								),
							)
					);
				} else {

					$addPayMethod=array(
								'section_title_recpacha_on_addpaymentmethod' => array(
									'name' => __('Recaptcha On Add Payment Method Login', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_addpaymentmethod',
								),
								'i13_recapcha_enable_on_addpaymentmethod' => array(
									'name' => __('Enable Recaptcha on Add Payment Method', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_addpaymentmethod',
								),
								'i13_recapcha_add_payment_method_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_add_payment_method_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_add_payment_method_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_add_payment_method_action_v3',
									'default' => 'add_payment_method',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
								/* 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_add_pay_method' => array(
								  'name' => __( 'Disable on the fly reCAPTCHA v3 token generation', 'recaptcha-for-woocommerce' ),
								  'type' => 'checkbox',
								  'id' => 'i13_recapcha_wp_disable_submit_token_generation_v3_woo_add_pay_method',
								  'desc' => __( 'Use only when there is problem with other plugin that use submit button. For example error like "Google reCAPTCHA token is missing" ', 'recaptcha-for-woocommerce' ),
								  'default' => ( 'yes' == $i13_recaptcha_fresh_install ) ? 'yes' : 'no',
								  ),
								 * 
								 */
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_addpaymentmethod',
								),
							);
					if ('google'!==$provider) {
						 
						 unset($addPayMethod['i13_recapcha_add_payment_method_score_threshold_v3']);
					}       
					
					if ('turnstile'==$provider) {
						
						$addPayMethod['i13_recapcha_add_payment_method_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						$addPayMethod['i13_recapcha_add_payment_method_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					} 
					
					
					$settings = apply_filters(
							'i13woocomm_addpaymentmethod_settings',
							$addPayMethod
					);
				}
			} else if ('wp_register' == $current_section) {

				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {
					
					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				if ('v2' == strtolower($reCapcha_version)) {

					$settings = apply_filters(
							'i13woocomm_wpregister_settings',
							array(
								'section_title_recpacha_on_wplogin' => array(
									'name' => __('Recaptcha On WP Registration', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_wpregister',
								),
								'i13_recapcha_enable_on_wpregister' => array(
									'name' => __('Enable Recaptcha on WP Registration', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_wpregister',
								),
								'i13_recapcha_wpregister_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_wpregister_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_wpregister' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_wpregister',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_wpregister_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_wpregister_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_wpregister_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_wpregister_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_wp_register' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_wp_register',
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_wpregister',
								),
							)
					);
				} else {

					 $arr_wp_reg= array(
								'section_title_recpacha_on_wplogin' => array(
									'name' => __('Recaptcha On WP Registration', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_wpregister',
								),
								'i13_recapcha_enable_on_wpregister' => array(
									'name' => __('Enable Recaptcha on WP Registration', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_wpregister',
								),
								'i13_recapcha_wp_register_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'step' => 'any',
									'id' => 'i13_recapcha_wp_register_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_wp_register_method_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_wp_register_method_action_v3',
									'default' => 'wp_registration',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),

								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_wpregister',
								),
							);
					 if ('google'!==$provider) {
						 
						 unset($arr_wp_reg['i13_recapcha_wp_register_score_threshold_v3']);
					 }       
					
					 if ('turnstile'==$provider) {
						
						 $arr_wp_reg['i13_recapcha_wp_register_method_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						 $arr_wp_reg['i13_recapcha_wp_register_method_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					 } 
					
					$settings = apply_filters(
							'i13woocomm_wpregister_settings',
							$arr_wp_reg
					);
					
					 
				}
			} else if ('wp_lostpassword' == $current_section) {

				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {
					
					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				if ('v2' == strtolower($reCapcha_version)) {
					$settings = apply_filters(
							'i13woocomm_wplostpassword_settings',
							array(
								'section_title_recpacha_on_wplostpassword' => array(
									'name' => __('Recaptcha On WP Lost Password', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_wplostpassword',
								),
								'i13_recapcha_enable_on_wplostpassword' => array(
									'name' => __('Enable Recaptcha on WP Lost Password', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_wplostpassword',
								),
								'i13_recapcha_wplostpassword_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_wplostpassword_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_wplostpassword' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_wplostpassword',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_wplostpassword_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_wplostpassword_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_wplostpassword_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_wplostpassword_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_wp_lost_password' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_wp_lost_password',
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_wplostpassword',
								),
							)
					);
				} else {

					$wp_lost_pass=array(
								'section_title_recpacha_on_wplostpassword' => array(
									'name' => __('Recaptcha On WP Lost Password', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_wplostpassword',
								),
								'i13_recapcha_enable_on_wplostpassword' => array(
									'name' => __('Enable Recaptcha on WP Lost Password', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_wplostpassword',
								),
								'i13_recapcha_wp_lost_password_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_wp_lost_password_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_wp_lost_password_method_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_wp_lost_password_method_action_v3',
									'default' => 'wp_forgot_password',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
							  
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_wplostpassword',
								),
							);
					if ('google'!==$provider) {
						 
						 unset($wp_lost_pass['i13_recapcha_wp_lost_password_score_threshold_v3']);
					}       
					
					if ('turnstile'==$provider) {
						
						$wp_lost_pass['i13_recapcha_wp_lost_password_method_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						$wp_lost_pass['i13_recapcha_wp_lost_password_method_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					} 
					
					$settings = apply_filters(
							'i13woocomm_wplostpassword_settings',
							$wp_lost_pass
					);
				}
			} else if ('woo_review' == $current_section) {

				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {
					
					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				if ('v2' == strtolower($reCapcha_version)) {
					$settings = apply_filters(
							'i13woocomm_woo_review_settings',
							array(
								'section_title_recpacha_on_woo_review' => array(
									'name' => __('Recaptcha on product review form', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_woo_review',
								),
								'i13_recapcha_enable_on_woo_review' => array(
									'name' => __('Enable Recaptcha on product review form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_woo_review',
								),
								'i13_recapcha_woo_review_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_review_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_woo_review' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_woo_review',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_woo_review_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_woo_review_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_woo_review_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_woo_review_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_woo_review' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_woo_review',
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_woo_review',
								),
							)
					);
				} else {

					
					$woo_review=array(
								'section_title_recpacha_on_woo_review' => array(
									'name' => __('Recaptcha on product review form', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_woo_review',
								),
								'i13_recapcha_enable_on_woo_review' => array(
									'name' => __('Enable Recaptcha on product review form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_woo_review',
								),
								'i13_recapcha_woo_review_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_woo_review_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_woo_review_method_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_review_method_action_v3',
									'default' => 'review',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
							   
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_woo_review',
								),
							);
					
					if ('google'!==$provider) {
						 
						unset($woo_review['i13_recapcha_woo_review_score_threshold_v3']);
					}       
					
					if ('turnstile'==$provider) {
						
						$woo_review['i13_recapcha_woo_review_method_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						$woo_review['i13_recapcha_woo_review_method_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					} 
					
					$settings = apply_filters(
							'i13woocomm_woo_review_settings',
							$woo_review
					);
				}
			} else if ('woo_order_tracking' == $current_section) {

				
				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {
					
					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				if ('v2' == strtolower($reCapcha_version)) {
					$settings = apply_filters(
							'i13woocomm_woo_tracking_settings',
							array(
								'section_title_recpacha_on_woo_tracking' => array(
									'name' => __('Recaptcha on order tracking form', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_woo_tracking',
								),
								'i13_recapcha_enable_on_woo_tracking' => array(
									'name' => __('Enable Recaptcha on order tracking form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_woo_tracking',
								),
								'i13_recapcha_woo_tracking_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_tracking_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_woo_tracking' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_woo_tracking',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_woo_tracking_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_woo_tracking_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_woo_tracking_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_woo_tracking_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_woo_tracking' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_woo_tracking',
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_woo_tracking',
								),
							)
					);
				} else {

					
					 $oeder_track=array(
								'section_title_recpacha_on_woo_tracking' => array(
									'name' => __('Recaptcha on order tracking form', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_woo_tracking',
								),
								'i13_recapcha_enable_on_woo_tracking' => array(
									'name' => __('Enable Recaptcha on order tracking form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_woo_tracking',
								),
								'i13_recapcha_woo_tracking_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_woo_tracking_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_woo_tracking_method_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_tracking_method_action_v3',
									'default' => 'order_tracking',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
							 
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_woo_tracking',
								),
							);
					 if ('google'!==$provider) {
						 
						 unset($oeder_track['i13_recapcha_woo_tracking_score_threshold_v3']);
					 }       
					
					 if ('turnstile'==$provider) {
						
						 $oeder_track['i13_recapcha_woo_tracking_method_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						 $oeder_track['i13_recapcha_woo_tracking_method_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					 } 
					
					$settings = apply_filters(
							'i13woocomm_woo_tracking_settings',
							$oeder_track
					);
				}
			} else if ('woo_comments' == $current_section) {

				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {
					
					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				if ('v2' == strtolower($reCapcha_version)) {
					$settings = apply_filters(
							'i13woocomm_woo_comment_settings',
							array(
								'section_title_recpacha_on_woo_comment' => array(
									'name' => __('Recaptcha on comment form', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_woo_comment',
								),
								'i13_recapcha_enable_on_woo_comment' => array(
									'name' => __('Enable Recaptcha on comment form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_woo_comment',
								),
								'i13_recapcha_woo_comment_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_comment_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_woo_comment' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_woo_comment',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_woo_comment_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_woo_comment_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_woo_comment_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_woo_comment_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_woo_comment' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_woo_comment',
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_woo_comment',
								),
							)
					);
				} else {

					
					   $comment= array(
								'section_title_recpacha_on_woo_comment' => array(
									'name' => __('Recaptcha on comment form', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_woo_comment',
								),
								'i13_recapcha_enable_on_woo_comment' => array(
									'name' => __('Enable Recaptcha on comment form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_woo_comment',
								),
								'i13_recapcha_woo_comment_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_woo_comment_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_woo_comment_method_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_comment_method_action_v3',
									'default' => 'comment',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
							
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_woo_comment',
								),
							);
					   if ('google'!==$provider) {
						 
						  unset($comment['i13_recapcha_woo_comment_score_threshold_v3']);
					   }       
					
					   if ('turnstile'==$provider) {
						
						   $comment['i13_recapcha_woo_comment_method_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						   $comment['i13_recapcha_woo_comment_method_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					   } 
					
					$settings = apply_filters(
							'i13woocomm_woo_comment_settings',
							$comment
					);
				}
			} else if ('jetpack_form' == $current_section) {

				if ('google'==$provider) {
					$reCapcha_version = get_option('i13_recapcha_version');
				} else if ('turnstile'==$provider) {
					
					 $reCapcha_version = get_option('i13_turnstile_version');
				}
				if ('v2' == strtolower($reCapcha_version)) {
					$settings = apply_filters(
							'i13woocomm_woo_jetpack_settings',
							array(
								'section_title_recpacha_on_woo_jetpack' => array(
									'name' => __('Recaptcha on jetpack form', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_woo_jetpack',
								),
								'i13_recapcha_enable_on_woo_jetpack' => array(
									'name' => __('Enable Recaptcha on jetpack form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_woo_jetpack',
								),
								'i13_recapcha_woo_jetpack_title' => array(
									'name' => __('Recaptcha Field Title', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_jetpack_title',
									'default' => 'Captcha',
								),
								'i13_recapcha_hide_label_woo_jetpack' => array(
									'name' => __('Hide Label', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_hide_label_woo_jetpack',
									'default' => 'no',
									'desc' => __('Hide label on form?', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_woo_jetpack_theme' => array(
									'name' => __('Recaptcha Theme', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_woo_jetpack_theme',
									'options' => array(
										'light' => __('Light', 'recaptcha-for-woocommerce'),
										'dark' => __('Dark', 'recaptcha-for-woocommerce'),
									),
									'default' => 'light',
								),
								'i13_recapcha_woo_jetpack_size' => array(
									'name' => __('Recaptcha Size', 'recaptcha-for-woocommerce'),
									'type' => 'radio',
									'id' => 'i13_recapcha_woo_jetpack_size',
									'options' => array(
										'normal' => __('Normal', 'recaptcha-for-woocommerce'),
										'compact' => __('Compact', 'recaptcha-for-woocommerce'),
									),
									'default' => 'normal',
								),
								'i13_recapcha_disable_submitbtn_woo_jetpack' => array(
									'name' => __('Disable submit button', 'recaptcha-for-woocommerce'),
									'desc' => __('Disable submit button until recaptcha validate.', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_disable_submitbtn_woo_jetpack',
								),
								'i13_recapcha_woo_jetpack_exclude' => array(
									'name' => __('Do not show a captcha for the following forms', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_jetpack_exclude',
									'default' => '',
									'desc' => __('Comma-separated jetpack page/post id (where form added) for which you do not want to show a captcha', 'recaptcha-for-woocommerce'),
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_woo_jetpack',
								),
							)
					);
				} else {

					
					
					$jetpack=array(
								'section_title_recpacha_on_woo_jetpack' => array(
									'name' => __('Recaptcha on jetpack form', 'recaptcha-for-woocommerce'),
									'type' => 'title',
									'desc' => '',
									'id' => 'wc_settings_tab_recapcha_woo_jetpack',
								),
								'i13_recapcha_enable_on_woo_jetpack' => array(
									'name' => __('Enable Recaptcha on jetpack form', 'recaptcha-for-woocommerce'),
									'type' => 'checkbox',
									'id' => 'i13_recapcha_enable_on_woo_jetpack',
								),
								'i13_recapcha_woo_jetpack_score_threshold_v3' => array(
									'name' => __('Recaptcha score threshold', 'recaptcha-for-woocommerce'),
									'type' => 'custom_type_number',
									'id' => 'i13_recapcha_woo_jetpack_score_threshold_v3',
									'default' => '0.5',
									'desc' => __('Instead of showing a CAPTCHA challenge, reCAPTCHA v3 returns a score so you can choose the most appropriate action for your website. The score is based on interactions with your site and enables you to take an appropriate action for your site. Recaptcha will rank traffic and interactions based on a score of 0.0 to 1.0, with a 1.0 being a good interaction and scores closer to 0.0 indicating a good likelihood that the traffic was generated by bots', 'recaptcha-for-woocommerce'),
								),
								'i13_recapcha_woo_jetpack_method_action_v3' => array(
									'name' => __('Recaptcha Action Name', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_jetpack_method_action_v3',
									'default' => 'contact_form',
									'desc' => __('In reCAPTCHA v3, Google introducing a new concept called “Action” —a tag that you can use to define the key steps of your user journey and enable reCAPTCHA to run its risk analysis in context.', 'recaptcha-for-woocommerce'),
								),
							   
								'i13_recapcha_woo_jetpack_exclude' => array(
									'name' => __('Do not show a captcha for the following forms', 'recaptcha-for-woocommerce'),
									'type' => 'text',
									'id' => 'i13_recapcha_woo_jetpack_exclude',
									'default' => '',
									'desc' => __('Comma-separated jetpack page/post id (where form added) for which you do not want to show a captcha', 'recaptcha-for-woocommerce'),
								),
								array(
									'type' => 'sectionend',
									'id' => 'wc_settings_tab_recapcha_woo_jetpack',
								),
							);
					
					if ('google'!==$provider) {
						 
						unset($jetpack['i13_recapcha_woo_jetpack_score_threshold_v3']);
					}       
					
					if ('turnstile'==$provider) {
						
						$jetpack['i13_recapcha_woo_jetpack_method_action_v3']['desc']=__('In turnstile hidden mode, You can add “Action” —a tag that you can use to define the key steps of your user journey and it will used to validate action on validation of captcha.', 'recaptcha-for-woocommerce');
						$jetpack['i13_recapcha_woo_jetpack_method_action_v3']['name']=__('Captcha Action Name', 'recaptcha-for-woocommerce');
					} 
					$settings = apply_filters(
							'i13woocomm_woo_jetpack_settings',
							$jetpack
					);
				}
			} else {

				/**
				 * Filter Plugin Section 1 Settings
				 *
				 * @since 1.0.0
				 * @param array $settings Array of the plugin settings
				 */
				

				$reCapcha_version = get_option('i13_recapcha_version');
				$i13_recaptcha_fresh_install = get_option('i13_recaptcha_fresh_install');
				if ('' == $reCapcha_version && '' == $i13_recaptcha_fresh_install) {
					add_option('i13_recaptcha_fresh_install', 'yes');
				}
				$arr = array();
				$arr['section_title'] = array(
					'name' => __('Recaptcha Settings', 'recaptcha-for-woocommerce'),
					'type' => 'title',
					'id' => 'wc_settings_tab_recapcha',
				);

				$arr['i13_captcha_provider'] = array(
					'name' => __('Choose Provider', 'recaptcha-for-woocommerce'),
					'desc' => __('Choose captcha provider', 'recaptcha-for-woocommerce'),
					'id' => 'i13_captcha_provider',
					'css' => 'min-width:150px;',
					'std' => 'left',
					'class' => 'i13-provider-select',
					'default' => 'recaptcha',
					'type' => 'select',
					'options' => array(
						'google' => __('Google reCaptcha', 'recaptcha-for-woocommerce'),
						'turnstile' => __('Cloudflare Turnstile', 'recaptcha-for-woocommerce'),
						/*'hcaptcha' => __('hCaptcha', 'recaptcha-for-woocommerce'),*/
					),
				   
				);

				if ('google' == $provider) {


					$arr['i13_recapcha_use_enterprise_recaptcha'] = array(
						'name' => __('Use enterprise reCaptcha?', 'recaptcha-for-woocommerce'),
						'type' => 'checkbox',
						'id' => 'i13_recapcha_use_enterprise_recaptcha',
						'desc' => __('Enterprise reCaptcha use Site Key, Google Cloud Project ID and Google Cloud API key while Classic reCaptcha use Site Key and Secret Key (Legacy Key)', 'recaptcha-for-woocommerce') . '&nbsp;<div id="i13_guide_classic" style="font-weight:bold;margin-top:10px">' . __('Please use this guideline to get classic reCaptcha Keys ', 'recaptcha-for-woocommerce') . '<a target="_blank" href="http://blog.i13websolution.com/how-to-get-google-recaptcha-v2-checkbox-keys/">' . __('reCaptcha keys V2 (checkbox)', 'recaptcha-for-woocommerce') . ' </a> &nbsp;&nbsp;<a target="_blank" href="http://blog.i13websolution.com/how-to-get-google-recaptcha-v3-keys/">' . __('reCaptcha keys V3', 'recaptcha-for-woocommerce') . ' </a></div>&nbsp;<div id="i13_guide_enterprise" style="font-weight:bold;margin-top:10px">' . __('Please use this guideline to get enterprise reCaptcha Keys like Site Key, Google Cloud Project ID and Google Cloud API key ', 'recaptcha-for-woocommerce') . '<a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v2-checkbox-enterprise-keys/">' . __('reCaptcha keys V2 (checkbox)', 'recaptcha-for-woocommerce') . '</a> &nbsp;&nbsp;<a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v3-enterprise-keys/">' . __('reCaptcha keys V3 ', 'recaptcha-for-woocommerce') . '</a></div>',
						'default' => 'no',
					);
					$arr['i13_recapcha_version'] = array(
						'name' => __('Recaptcha Version', 'recaptcha-for-woocommerce'),
						'type' => 'radio',
						'id' => 'i13_recapcha_version',
						'options' => array(
							'v2' => __('ReCaptcha V2 (checkbox)', 'recaptcha-for-woocommerce'),
							'v3' => __('ReCaptcha V3', 'recaptcha-for-woocommerce'),
						),
						'default' => 'v2',
					);
					$arr['custom_type_text'] = array(
						'type' => 'custom_type_text',
						'id' => 'i13_recapcha_custom_type',
						'desc' => __('Recaptcha V3 does not show any challenge like I am not robot etc. ReCaptcha V3 uses a behind-the-scenes scoring system to detect abusive traffic, and lets you decide the minimum passing score. Please note that there is no user interaction shown in reRecapcha V3 meaning that no recaptcha challenge is shown to solve.', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_use_both_recaptcha'] = array(
						'name' => __('Show reCaptcha V2 ( I am not robot) on V3 failure (Fallback reCaptcha)', 'recaptcha-for-woocommerce'),
						'type' => 'checkbox',
						'id' => 'i13_recapcha_use_both_recaptcha',
						'desc' => __('As reCaptcha V3 is fully algorithm-based, Sometimes it may block legit users due to false positive issues like VPN/Firewall etc, In this case show V2 reCaptcha as fallback.', 'recaptcha-for-woocommerce'),
						'default' => 'no',
					);
					$arr['i13_recapcha_site_key_v3'] = array(
						'name' => __('reCaptcha V3 Site Key', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'desc' => '<div id="classic_v3"><a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v3-keys/">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get reCaptcha V3 site key', 'recaptcha-for-woocommerce') . '</div><div id="enterprise_v3"><a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v3-enterprise-keys/#create_site_key">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get reCaptcha V3 site key', 'recaptcha-for-woocommerce') . '</di>',
						'id' => 'wc_settings_tab_recapcha_site_key_v3',
					);
					$arr['i13_recapcha_secret_key_v3'] = array(
						'name' => __('reCaptcha V3 Secret Key', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'desc' => '<a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v3-keys/">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get reCaptcha V3 secret key ', 'recaptcha-for-woocommerce'),
						'id' => 'wc_settings_tab_recapcha_secret_key_v3',
					);
					$arr['i13_recapcha_google_cloud_api_key_v3'] = array(
						'name' => __('reCaptcha V3 Google Cloud Project API Key', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'desc' => '<a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v3-enterprise-keys/#get_cloud_api_key">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get Google Cloud Project API Key', 'recaptcha-for-woocommerce'),
						'id' => 'i13_recapcha_google_cloud_api_key_v3',
					);
					$arr['i13_recapcha_google_cloud_project_id_v3'] = array(
						'name' => __('reCaptcha V3 Google Cloud Project ID', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'desc' => '<a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v3-enterprise-keys/#get_cloud_project_id">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get Google Cloud Project ID', 'recaptcha-for-woocommerce'),
						'id' => 'i13_recapcha_google_cloud_project_id_v3',
					);
					$arr['i13_recapcha_site_key'] = array(
						'name' => __('reCaptcha V2 Site Key', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'desc' => '<div id="classic_v2"><a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v2-checkbox-keys/">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get reCaptcha V2 site key', 'recaptcha-for-woocommerce') . '</div><div id="enterprise_v2"><a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v2-checkbox-enterprise-keys/#create_site_key">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get reCaptcha V2 site key', 'recaptcha-for-woocommerce') . '</di>',
						'id' => 'wc_settings_tab_recapcha_site_key',
					);
					$arr['i13_recapcha_secret_key'] = array(
						'name' => __('reCaptcha V2 Secret Key', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'desc' => '<a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v2-checkbox-keys/">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get reCaptcha V2 secret key ', 'recaptcha-for-woocommerce'),
						'id' => 'wc_settings_tab_recapcha_secret_key',
					);
					$arr['i13_recapcha_google_cloud_api_key'] = array(
						'name' => __('reCaptcha V2 Google Cloud Project API Key', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'desc' => '<a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v2-checkbox-enterprise-keys/#get_cloud_api_key">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get Google Cloud Project API Key', 'recaptcha-for-woocommerce'),
						'id' => 'i13_recapcha_google_cloud_api_key',
					);
					$arr['i13_recapcha_google_cloud_project_id'] = array(
						'name' => __('reCaptcha V2 Google Cloud Project ID', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'desc' => '<a target="_blank" href="https://blog.i13websolution.com/how-to-get-google-recaptcha-v2-checkbox-enterprise-keys/#get_cloud_project_id">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get Google Cloud Project ID', 'recaptcha-for-woocommerce'),
						'id' => 'i13_recapcha_google_cloud_project_id',
					);
					$arr['i13_recapcha_v2_timeout'] = array(
						'name' => __('Validity to switch back to v3', 'recaptcha-for-woocommerce'),
						'type' => 'number',
						'id' => 'i13_recapcha_v2_timeout',
						'default' => '10',
						'desc' => __('After V3 has a verification issue for a particular action like checkout/signup etc. It will show V2 to complete the action. It will switch back to V3 upon action complete, After how many minutes switch back to V3 if action not complete ?.', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_error_msg_v3_invalid_captcha'] = array(
						'name' => __('Error message recaptcha verification failed', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'id' => 'i13_recapcha_error_msg_v3_invalid_captcha',
						'default' => 'Google reCAPTCHA verification failed, please try again later',
						'desc' => __('This message shown when google detect abusive, invalid, spam, bot etc traffic', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_error_msg_captcha_blank_v3'] = array(
						'name' => __('Error message recaptcha blank', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'id' => 'i13_recapcha_error_msg_captcha_blank_v3',
						'default' => 'Google reCAPTCHA token is missing',
					);
					$arr['i13_recapcha_msg_token_generation'] = array(
						'name' => __('Message when reCaptcha generating token', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'id' => 'i13_recapcha_msg_token_generation',
						'default' => 'Generating reCaptcha token, Please wait...',
					);
					$arr['i13_recapcha_error_msg_captcha_no_response_v3'] = array(
						'name' => __('Error message for can not connect to server', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'id' => 'i13_recapcha_error_msg_captcha_no_response_v3',
						'default' => 'Could not get response from reCAPTCHA server.',
					);
					$arr['i13_recapcha_error_msg_captcha_blank'] = array(
						'name' => __('Error message recaptcha blank', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'id' => 'wc_settings_tab_recapcha_error_msg_captcha_blank',
						'default' => '[recaptcha] is a required field.',
						'desc' => __('[recaptcha] will replaced with captcha field title', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_error_msg_captcha_no_response'] = array(
						'name' => __('Error message for can not connect to server ', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'id' => 'wc_settings_tab_recapcha_error_msg_captcha_no_response',
						'default' => 'Could not get response from [recaptcha] server.',
						'desc' => __('[recaptcha] will replaced with captcha field title', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_error_msg_captcha_invalid'] = array(
						'name' => __('Error message for invalid captcha', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'id' => 'wc_settings_tab_recapcha_error_msg_captcha_invalid',
						'default' => 'Invalid [recaptcha].',
						'desc' => __('[recaptcha] will replaced with captcha field title', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_error_msg_invalid_order_origin'] = array(
						'name' => __('Error message for “unknown” origin order', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'id' => 'i13_recapcha_error_msg_invalid_order_origin',
						'default' => 'Order with an unknown origin is not allowed',
						'desc' => __('Error message for “unknown” origin order', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_no_conflict'] = array(
						'name' => __('No-Conflict Mode', 'recaptcha-for-woocommerce'),
						'type' => 'checkbox',
						'id' => 'i13_recapcha_no_conflict',
						'desc' => __('When checked, other reCAPTCHA occurrences on this plugin sections like checkout, registration, login etc are forcefully removed, to prevent conflicts. Only check if your site is having compatibility issues or instructed to by support.', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_domain'] = array(
						'name' => __('Use global reCaptcha Domain', 'recaptcha-for-woocommerce'),
						'type' => 'checkbox',
						'id' => 'i13_recapcha_domain',
						'desc' => __('google.com is blocked in certain countries like china, So if you are site doing business on such countries please enable this option. This will use recaptcha.net instead of google.com for service.', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_no_conflict_v3'] = array(
						'name' => __('No-Conflict Mode', 'recaptcha-for-woocommerce'),
						'type' => 'checkbox',
						'id' => 'i13_recapcha_no_conflict_v3',
						'desc' => __('When checked, other reCAPTCHA occurrences on this plugin sections like checkout, registration, login etc are forcefully removed, to prevent conflicts. Only check if your site is having compatibility issues or instructed to by support.', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_ip_to_skip_captcha'] = array(
						'name' => __('Ip or Range of IP', 'recaptcha-for-woocommerce'),
						'type' => 'text',
						'id' => 'i13_recapcha_ip_to_skip_captcha',
						'default' => '',
						'desc' => __('Useful when you want to not show reCaptcha for certain users/clients. When requests comes through the above IP or IP range the reCaptcha is not shown and validation will skipped. for example 123.201.160.11,123.201.160.11-123.201.160.50', 'recaptcha-for-woocommerce'),
					);
					$arr['i13_recapcha_v2_lang'] = array(
						'name' => __('Language Code', 'recaptcha-for-woocommerce'),
						'desc' => __('Choose language for recaptcha V2 when shown. For example translation of I am not robot.', 'recaptcha-for-woocommerce'),
						'id' => 'i13_recapcha_v2_lang',
						'css' => 'min-width:150px;',
						'std' => 'left',
						'default' => 'en',
						'type' => 'select',
						'options' => array(
							'ar' => __('Arabic', 'recaptcha-for-woocommerce'),
							'af' => __('Afrikaans', 'recaptcha-for-woocommerce'),
							'am' => __('Amharic', 'recaptcha-for-woocommerce'),
							'hy' => __('Armenian', 'recaptcha-for-woocommerce'),
							'az' => __('Azerbaijani', 'recaptcha-for-woocommerce'),
							'eu' => __('Basque', 'recaptcha-for-woocommerce'),
							'bn' => __('Bengali', 'recaptcha-for-woocommerce'),
							'bg' => __('Bulgarian', 'recaptcha-for-woocommerce'),
							'ca' => __('Catalan', 'recaptcha-for-woocommerce'),
							'zh-HK' => __('Chinese (Hong Kong)', 'recaptcha-for-woocommerce'),
							'zh-CN' => __('Chinese (Simplified)', 'recaptcha-for-woocommerce'),
							'zh-TW' => __('Chinese (Traditional)', 'recaptcha-for-woocommerce'),
							'hr' => __('Croatian', 'recaptcha-for-woocommerce'),
							'cs' => __('Czech', 'recaptcha-for-woocommerce'),
							'da' => __('Danish', 'recaptcha-for-woocommerce'),
							'nl' => __('Dutch', 'recaptcha-for-woocommerce'),
							'en-GB' => __('English (UK)', 'recaptcha-for-woocommerce'),
							'en' => __('English (US)', 'recaptcha-for-woocommerce'),
							'et' => __('Estonian', 'recaptcha-for-woocommerce'),
							'fil' => __('Filipino', 'recaptcha-for-woocommerce'),
							'fr' => __('French', 'recaptcha-for-woocommerce'),
							'fr-CA' => __('French (Canadian)', 'recaptcha-for-woocommerce'),
							'gl' => __('Galician', 'recaptcha-for-woocommerce'),
							'ka' => __('Georgian', 'recaptcha-for-woocommerce'),
							'de' => __('German', 'recaptcha-for-woocommerce'),
							'de-AT' => __('German (Austria)', 'recaptcha-for-woocommerce'),
							'de-CH' => __('German (Switzerland)', 'recaptcha-for-woocommerce'),
							'el' => __('Greek', 'recaptcha-for-woocommerce'),
							'gu' => __('Gujarati', 'recaptcha-for-woocommerce'),
							'iw' => __('Hebrew', 'recaptcha-for-woocommerce'),
							'hi' => __('Hindi', 'recaptcha-for-woocommerce'),
							'hu' => __('Hungarain', 'recaptcha-for-woocommerce'),
							'is' => __('Icelandic', 'recaptcha-for-woocommerce'),
							'id' => __('Indonesian', 'recaptcha-for-woocommerce'),
							'it' => __('Italian', 'recaptcha-for-woocommerce'),
							'ja' => __('Japanese', 'recaptcha-for-woocommerce'),
							'kn' => __('Kannada', 'recaptcha-for-woocommerce'),
							'ko' => __('Korean', 'recaptcha-for-woocommerce'),
							'lo' => __('Laothian', 'recaptcha-for-woocommerce'),
							'lv' => __('Latvian', 'recaptcha-for-woocommerce'),
							'lt' => __('Lithuanian', 'recaptcha-for-woocommerce'),
							'ms' => __('Malay', 'recaptcha-for-woocommerce'),
							'ml' => __('Malayalam', 'recaptcha-for-woocommerce'),
							'mr' => __('Marathi', 'recaptcha-for-woocommerce'),
							'mn' => __('Mongolian', 'recaptcha-for-woocommerce'),
							'no' => __('Norwegian', 'recaptcha-for-woocommerce'),
							'fa' => __('Persian', 'recaptcha-for-woocommerce'),
							'pl' => __('Polish', 'recaptcha-for-woocommerce'),
							'pt' => __('Portuguese', 'recaptcha-for-woocommerce'),
							'pt-BR' => __('Portuguese (Brazil)', 'recaptcha-for-woocommerce'),
							'pt-PT' => __('Portuguese (Portugal)', 'recaptcha-for-woocommerce'),
							'ro' => __('Romanian', 'recaptcha-for-woocommerce'),
							'ru' => __('Russian', 'recaptcha-for-woocommerce'),
							'sr' => __('Serbian', 'recaptcha-for-woocommerce'),
							'si' => __('Sinhalese', 'recaptcha-for-woocommerce'),
							'sk' => __('Slovak', 'recaptcha-for-woocommerce'),
							'sl' => __('Slovenian', 'recaptcha-for-woocommerce'),
							'es' => __('Spanish', 'recaptcha-for-woocommerce'),
							'es-419' => __('Spanish (Latin America)', 'recaptcha-for-woocommerce'),
							'sw' => __('Swahili', 'recaptcha-for-woocommerce'),
							'sv' => __('Swedish', 'recaptcha-for-woocommerce'),
							'ta' => __('Tamil', 'recaptcha-for-woocommerce'),
							'te' => __('Telugu', 'recaptcha-for-woocommerce'),
							'th' => __('Thai', 'recaptcha-for-woocommerce'),
							'tr' => __('Turkish', 'recaptcha-for-woocommerce'),
							'uk' => __('Ukrainian', 'recaptcha-for-woocommerce'),
							'ur' => __('Urdu', 'recaptcha-for-woocommerce'),
							'vi' => __('Vietnamese', 'recaptcha-for-woocommerce'),
							'zu' => __('Zulu', 'recaptcha-for-woocommerce'),
						)
					);
					
				   $arr['custome_type'] = array(
												'type' => 'custom_type',
												'id' => 'i13_recapcha_custom_type',
										);
				  
				} else if ('turnstile'==$provider) {
					
					   
					   $arr['i13_turnstile_version'] = array(
						   'name' => __('Captcha Type', 'recaptcha-for-woocommerce'),
						   'type' => 'radio',
						   'id' => 'i13_turnstile_version',
						   'options' => array(
							   'v2' => __('Checkbox', 'recaptcha-for-woocommerce'),
							   'v3' => __('Hidden', 'recaptcha-for-woocommerce'),
						   ),
						   'default' => 'v2',
					   );
					   $arr['custom_type_text'] = array(
						   'type' => 'custom_type_text',
						   'id' => 'i13_turnstile_custom_type',
						   'desc' => __('Turnstile hidden captcha does not show any challenge to solve etc. Hidden mode that works invisibly in the background, using JavaScript challenges and user behavior analysis to verify humans vs. bots, reducing friction for legitimate users while stopping spam without constant visual puzzles.', 'recaptcha-for-woocommerce'),
					   );
					   $arr['i13_turnstile_use_both_recaptcha'] = array(
						   'name' => __('Show Checkbox mode on hidden mode failure (Fallback Captcha)', 'recaptcha-for-woocommerce'),
						   'type' => 'checkbox',
						   'id' => 'i13_turnstile_use_both_recaptcha',
						   'desc' => __('As hidden mode is fully algorithm-based, Sometimes it may block legit users due to false positive issues like VPN/Firewall etc, In this case show checkbox as fallback.', 'recaptcha-for-woocommerce'),
						   'default' => 'no',
					   );
					   $arr['i13_turnstile_site_key_v3'] = array(
						   'name' => __('Hidden mode Site Key', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'desc' => '<div id="turnstile_v3"><a target="_blank" href="https://blog.i13websolution.com/how-to-get-turnstile-hidden-mode-keys/">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get turnstile hidden mode site key', 'recaptcha-for-woocommerce') . '</div>',
						   'id' => 'wc_settings_tab_turnstile_site_key_v3',
					   );
					   $arr['i13_turnstile_secret_key_v3'] = array(
						   'name' => __('Hidden mode Secret Key', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'desc' => '<a target="_blank" href="https://blog.i13websolution.com/how-to-get-turnstile-hidden-mode-keys/">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get hidden mode secret key ', 'recaptcha-for-woocommerce'),
						   'id' => 'wc_settings_tab_turnstile_secret_key_v3',
					   );
					   
					   $arr['i13_turnstile_site_key'] = array(
						   'name' => __('Checkbox mode Site Key', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'desc' => '<div id="turnstile_v2"><a target="_blank" href="https://blog.i13websolution.com/how-to-get-turnstile-checkbox-mode-keys/">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get turnstile checkbox mode site key', 'recaptcha-for-woocommerce') . '</div>',
						   'id' => 'wc_settings_tab_turnstile_site_key',
					   );
					   $arr['i13_turnstile_secret_key'] = array(
						   'name' => __('Checkbox mode Secret Key', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'desc' => '<a target="_blank" href="https://blog.i13websolution.com/how-to-get-turnstile-checkbox-mode-keys/">' . __('Click here', 'recaptcha-for-woocommerce') . '</a>' . __(' to know How to get turnstile checkbox secret key ', 'recaptcha-for-woocommerce'),
						   'id' => 'wc_settings_tab_turnstile_secret_key',
					   );
					  
					   $arr['i13_turnstile_v2_timeout'] = array(
						   'name' => __('Validity to switch back to hidden mode', 'recaptcha-for-woocommerce'),
						   'type' => 'number',
						   'id' => 'i13_turnstile_v2_timeout',
						   'default' => '10',
						   'desc' => __('After hidden mode has a verification issue for a particular action like checkout/signup etc. It will show checkbox mode to complete the action. It will switch back to hidden mode upon action complete, After how many minutes switch back to hidden mode if action not complete ?.', 'recaptcha-for-woocommerce'),
					   );
					   $arr['i13_turnstile_error_msg_v3_invalid_captcha'] = array(
						   'name' => __('Error message turnstile verification failed', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'id' => 'i13_turnstile_error_msg_v3_invalid_captcha',
						   'default' => 'Turnstile captcha verification failed, please try again later',
						   'desc' => __('This message shown when turnstile detect abusive, invalid, spam, bot etc traffic', 'recaptcha-for-woocommerce'),
					   );
					   $arr['i13_turnstile_error_msg_captcha_blank_v3'] = array(
						   'name' => __('Error message turnstile captcha blank', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'id' => 'i13_turnstile_error_msg_captcha_blank_v3',
						   'default' => 'Turnstile token is missing',
					   );
					   $arr['i13_turnstile_msg_token_generation'] = array(
						   'name' => __('Message when turnstile generating token', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'id' => 'i13_turnstile_msg_token_generation',
						   'default' => 'Generating turnstile token, Please wait...',
					   );
					   $arr['i13_turnstile_error_msg_captcha_no_response_v3'] = array(
						   'name' => __('Error message for can not connect to server', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'id' => 'i13_turnstile_error_msg_captcha_no_response_v3',
						   'default' => 'Could not get response from turnstile server.',
					   );
					   $arr['i13_turnstile_error_msg_captcha_blank'] = array(
						   'name' => __('Error message turnstile captcha blank', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'id' => 'wc_settings_tab_turnstile_error_msg_captcha_blank',
						   'default' => '[captcha] is a required field.',
						   'desc' => __('[captcha] will replaced with captcha field title', 'recaptcha-for-woocommerce'),
					   );
					   $arr['i13_turnstile_error_msg_captcha_no_response'] = array(
						   'name' => __('Error message for can not connect to server ', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'id' => 'wc_settings_tab_turnstile_error_msg_captcha_no_response',
						   'default' => 'Could not get response from [captcha] server.',
						   'desc' => __('[captcha] will replaced with captcha field title', 'recaptcha-for-woocommerce'),
					   );
					   $arr['i13_turnstile_error_msg_captcha_invalid'] = array(
						   'name' => __('Error message for invalid captcha', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'id' => 'wc_settings_tab_turnstile_error_msg_captcha_invalid',
						   'default' => 'Invalid [captcha].',
						   'desc' => __('[captcha] will replaced with captcha field title', 'recaptcha-for-woocommerce'),
					   );
					   $arr['i13_turnstile_error_msg_invalid_order_origin'] = array(
						   'name' => __('Error message for “unknown” origin order', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'id' => 'i13_turnstile_error_msg_invalid_order_origin',
						   'default' => 'Order with an unknown origin is not allowed',
						   'desc' => __('Error message for “unknown” origin order', 'recaptcha-for-woocommerce'),
					   );
					   $arr['i13_turnstile_no_conflict'] = array(
						   'name' => __('No-Conflict Mode', 'recaptcha-for-woocommerce'),
						   'type' => 'checkbox',
						   'id' => 'i13_turnstile_no_conflict',
						   'desc' => __('When checked, other turnstile occurrences on this plugin sections like checkout, registration, login etc are forcefully removed, to prevent conflicts. Only check if your site is having compatibility issues or instructed to by support.', 'recaptcha-for-woocommerce'),
					   );
					   $arr['i13_turnstile_no_conflict_v3'] = array(
						   'name' => __('No-Conflict Mode', 'recaptcha-for-woocommerce'),
						   'type' => 'checkbox',
						   'id' => 'i13_turnstile_no_conflict_v3',
						   'desc' => __('When checked, other turnstile occurrences on this plugin sections like checkout, registration, login etc are forcefully removed, to prevent conflicts. Only check if your site is having compatibility issues or instructed to by support.', 'recaptcha-for-woocommerce'),
					   );
					   
					  
					   $arr['i13_recapcha_ip_to_skip_captcha'] = array(
						   'name' => __('Ip or Range of IP', 'recaptcha-for-woocommerce'),
						   'type' => 'text',
						   'id' => 'i13_recapcha_ip_to_skip_captcha',
						   'default' => '',
						   'desc' => __('Useful when you want to not show reCaptcha for certain users/clients. When requests comes through the above IP or IP range the reCaptcha is not shown and validation will skipped. for example 123.201.160.11,123.201.160.11-123.201.160.50', 'recaptcha-for-woocommerce'),
					   );
					   $arr['i13_turnstile_v2_lang'] = array(
						   'name' => __('Language Code', 'recaptcha-for-woocommerce'),
						   'desc' => __('Choose language for turnstile V2 when shown. For example translation of I am not robot.', 'recaptcha-for-woocommerce'),
						   'id' => 'i13_turnstile_v2_lang',
						   'css' => 'min-width:150px;',
						   'std' => 'left',
						   'default' => 'en',
						   'type' => 'select',
						   'options' => array(
							   'ar' => __('Arabic', 'recaptcha-for-woocommerce'),
								'bg' => __('Bulgarian', 'recaptcha-for-woocommerce'),
								'zh' => __('Chinese (Simplified)', 'recaptcha-for-woocommerce'),
								'hr' => __('Croatian', 'recaptcha-for-woocommerce'),
								'cs' => __('Czech', 'recaptcha-for-woocommerce'),
								'da' => __('Danish', 'recaptcha-for-woocommerce'),
								'nl' => __('Dutch', 'recaptcha-for-woocommerce'),
								'en' => __('English', 'recaptcha-for-woocommerce'),
								'fa' => __('Farsi', 'recaptcha-for-woocommerce'),
								'fi' => __('Finnish', 'recaptcha-for-woocommerce'),
								'fr' => __('French', 'recaptcha-for-woocommerce'),
								'de' => __('German', 'recaptcha-for-woocommerce'),
								'el' => __('Greek', 'recaptcha-for-woocommerce'),
								'he' => __('Hebrew', 'recaptcha-for-woocommerce'),
								'hi' => __('Hindi', 'recaptcha-for-woocommerce'),
								'hu' => __('Hungarian', 'recaptcha-for-woocommerce'),
								'id' => __('Indonesian', 'recaptcha-for-woocommerce'),
								'it' => __('Italian', 'recaptcha-for-woocommerce'),
								'ja' => __('Japanese', 'recaptcha-for-woocommerce'),
								'ko' => __('Korean', 'recaptcha-for-woocommerce'),
								'lt' => __('Lithuanian', 'recaptcha-for-woocommerce'),
								'ms' => __('Malay', 'recaptcha-for-woocommerce'),
								'nb' => __('Norwegian Bokmål', 'recaptcha-for-woocommerce'),
								'pl' => __('Polish', 'recaptcha-for-woocommerce'),
								'pt' => __('Portuguese (Brazil)', 'recaptcha-for-woocommerce'),
								'ro' => __('Romanian', 'recaptcha-for-woocommerce'),
								'ru' => __('Russian', 'recaptcha-for-woocommerce'),
								'sr' => __('Serbian', 'recaptcha-for-woocommerce'),
								'sk' => __('Slovak', 'recaptcha-for-woocommerce'),
								'sl' => __('Slovenian', 'recaptcha-for-woocommerce'),
								'es' => __('Spanish', 'recaptcha-for-woocommerce'),
								'sv' => __('Swedish', 'recaptcha-for-woocommerce'),
								'tl' => __('Tagalog', 'recaptcha-for-woocommerce'),
								'th' => __('Thai', 'recaptcha-for-woocommerce'),
								'tr' => __('Turkish', 'recaptcha-for-woocommerce'),
								'uk' => __('Ukrainian', 'recaptcha-for-woocommerce'),
								'vi' => __('Vietnamese', 'recaptcha-for-woocommerce')
						   )
					   );
					   $arr['custome_type'] = array(
						   'type' => 'custom_type_turnstile',
						   'id' => 'i13_turnstile_custom_type',
					   );
				}
				
				$arr['wc_settings_tab_recapcha'] = array(
					'type' => 'sectionend',
					'id' => 'wc_settings_tab_recapcha',
				);

				  $settings = apply_filters(
						'i13woocomm_general_settings',
						$arr
				);
			   
			}

		 
		   
			/**
			 * Filter MyPlugin Settings
			 *
			 * @since 1.0.0
			 * @param array $settings Array of the plugin settings
			 */
			return apply_filters('woocommerce_get_settings_' . $this->id, $settings, $current_section);
		}

		/**
		 * Output the settings
		 *
		 * @since 1.0
		 */
		public function output() {

			global $current_section;

			$settings = $this->get_settings($current_section);
			WC_Admin_Settings::output_fields($settings);
		}

		public function save() {

			global $current_section;

			$settings = $this->get_settings($current_section);
			WC_Admin_Settings::save_fields($settings);
		}

	}

	endif;

return new I13_WooCommerce_Settings_Page();

