var PC=PC||{};PC.views=PC.views||{},(i=>{PC.views.content=Backbone.View.extend({tagName:"div",className:"state content-state",template:wp.template("mkl-pc-content"),events:{},collectionName:"content",initialize:function(t){this.options=t||{},this.admin=PC.app.get_admin(),this.product=PC.app.get_product(),PC.selection.reset(),this.product.get("content")||this.product.set("content",new PC.content_list),this.col=this.product.get("content"),this.render()},render:function(){var t;!this.admin.layers||!this.admin.angles||this.admin.layers.length<1||this.admin.angles.length<1?(t=wp.template("mkl-pc-content-no-data"),this.$el.append(t())):(this.$el.append(this.template()),this.$list=this.$(".content-layers-list"),this.$choices=this.$(".content-choices-list"),this.$form=this.$(".content-choice"),this.layers=new PC.views.content_layers({list_el:this.$list,edit_el:this.$form,state:this}),this.$list.append(this.layers.el))},get_col:function(){return this.col}}),PC.views.content_layers=Backbone.View.extend({tagName:"ul",className:"layers",initialize:function(t){return this.options=t||{},this.product=PC.app.get_product(),this.render(),this},render:function(){this.$el.empty(),PC.app.admin.layers.each(this.add_one,this)},add_one:function(t){var e;"group"!=t.get("type")&&"summary"!=t.get("type")&&(e=i.defaults(this.options),this.product.get("content"),e.model=t,t=new PC.views.content_layer(e),this.$el.append(t.el))}}),PC.views.content_layer=Backbone.View.extend({tagName:"li",template:wp.template("mkl-pc-content-layer"),events:{"click a.layer":"toggleLayer"},initialize:function(t){if(this.options=t||{},!this.options.state)return!1;this.product=PC.app.get_product(),this.state=this.options.state;t=this.product.get("content");t.get(this.model.id)||t.add({layerId:this.model.id,choices:new PC.choices([],{layer:PC.app.admin.layers.get(this.model.id)})}),this.choices=t.get(this.model.id).get("choices"),this.listenTo(this.choices,"add",this.udpate_number),this.listenTo(this.choices,"remove",this.udpate_number),this.render()},render:function(){var t=this.choices.length,e=i.defaults(this.model.attributes);e.choices_number=t,this.$el.empty(),this.$el.append(this.template(e)),this.model.get("active")&&this.$("a").trigger("click")},udpate_number:function(){this.$(".number-of-choices").text(this.choices.length)},toggleLayer:function(t){t.preventDefault(),this.state.active_layer&&this.state.active_layer.remove(),PC.selection.reset(),this.state.active_layer=new PC.views.choices({model:this.model,state:this.state}),this.state.$choices.append(this.state.active_layer.$el),this.state.$el.addClass("show-choices")}})})((jQuery,PC._us||window._));