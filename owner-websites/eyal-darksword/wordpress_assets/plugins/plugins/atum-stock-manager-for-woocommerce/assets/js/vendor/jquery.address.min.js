/*! jQuery Address v${version} | (c) Rostislav Hristov | jquery.org/license | FIXED BY ATUM TO AVOID DEPRECATED JQUERY FUNCTIONS */
!function(p){function e(t){return t=p.extend(p.Event(t),function(){for(var t={},e=p.address.parameterNames(),r=0,n=e.length;r<n;r++)t[e[r]]=p.address.parameter(e[r]);return{value:p.address.value(),path:p.address.path(),pathNames:p.address.pathNames(),parameterNames:e,parameters:t,queryString:p.address.queryString()}}.call(p.address)),p(p.address).trigger(t),t}function n(t){return Array.prototype.slice.call(t)}function a(t,e,r){return p().on.apply(p(p.address),Array.prototype.slice.call(arguments)),p.address}function r(){return _.pushState&&N.state!==f}function i(){return("/"+z.pathname.replace(new RegExp(N.state),"")+z.search+(w()?"#"+w():"")).replace(Q,"/")}function s(){return(r()?i:w)()}function o(){try{return top.document!==f&&top.document.title!==f&&top.jQuery!==f&&top.jQuery.address!==f&&!1!==top.jQuery.address.frames()?top:window}catch(t){return window}}function c(){return"javascript"}function u(t){return t=t.toString(),(N.strict&&"/"!=t.substr(0,1)?"/":"")+t}function d(t,e){return parseInt(t.css(e),10)}function l(){var t;H||(t=s(),decodeURI(Y)!=decodeURI(t)&&(C&&O<7?z.reload():(C&&!D&&N.history&&P(k,50),Y=t,b(q))))}function h(){if(K&&-1!=F){for(var t,e=K.substr(F+1).split("&"),r=0;r<e.length;r++)t=e[r].split("="),/^(autoUpdate|history|strict|wrap)$/.test(t[0])&&(N[t[0]]=isNaN(t[1])?/^(true|yes)$/i.test(t[1]):0!==parseInt(t[1],10)),/^(state|tracker)$/.test(t[0])&&(N[t[0]]=t[1]);K=E}Y=s()}function t(){var t;J||(J=A,h(),p('a[rel*="address:"]').address(),N.wrap&&(t=p("body"),p("body > *").wrapAll('<div style="padding:'+(d(t,"marginTop")+d(t,"paddingTop"))+"px "+(d(t,"marginRight")+d(t,"paddingRight"))+"px "+(d(t,"marginBottom")+d(t,"paddingBottom"))+"px "+(d(t,"marginLeft")+d(t,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+S+'" style="height:100%;overflow:auto;position:relative;'+(L&&!window.statusbar.visible?"resize:both;":"")+'" />'),p("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"}),L&&p('<style type="text/css" />').appendTo("head").text("#"+S+"::-webkit-resizer { background-color: #fff; }")),C&&!D&&(t=W.getElementsByTagName("frameset")[0],(g=W.createElement((t?"":"i")+"frame")).src=c()+":"+q,t?(t.insertAdjacentElement("beforeEnd",g),t[t.cols?"cols":"rows"]+=",0",g.noResize=A,g.frameBorder=g.frameSpacing=0):(g.style.display="none",g.style.width=g.style.height=0,g.tabIndex=-1,W.body.insertAdjacentElement("afterBegin",g)),P(function(){p(g).on("load",function(){var t=g.contentWindow;(Y=t[S]!==f?t[S]:"")!=s()&&(b(q),z.hash=Y)}),g.contentWindow[S]===f&&k()},50)),P(function(){e("init"),b(q)},1),r()||(C&&7<O||!C&&D?M.addEventListener?M.addEventListener(I,l,q):M.attachEvent&&M.attachEvent("on"+I,l):B(l,50)),"state"in window.history&&p(window).trigger("popstate"))}var f,g,v,m,y,w,b,x,k,E,S,I,U,j,R,T,A,q,N,$,O,L,C,M,W,_,z,B,P,Q,D,K,F,G,H,J,V,X,Y;p.address=(w=function(){var t=z.href.indexOf("#");return-1!=t?z.href.substr(t+1):""},b=function(t){return P(x,10),e(j).isDefaultPrevented()||e(t?R:T).isDefaultPrevented()},x=function(){var t,e;"null"!==N.tracker&&N.tracker!==E&&(t="function"==typeof N.tracker?N.tracker:M[N.tracker],e=(z.pathname+z.search+(p.address&&!r()?p.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,""),"function"==typeof t?t(e):("function"==typeof M.urchinTracker&&M.urchinTracker(e),M.pageTracker!==f&&"function"==typeof M.pageTracker._trackPageview&&M.pageTracker._trackPageview(e),M._gaq!==f&&"function"==typeof M._gaq.push&&M._gaq.push(["_trackPageview",decodeURI(e)]),"function"==typeof M.ga&&M.ga("send","pageview",e)))},k=function(){var t=c()+":"+q+";document.open();document.writeln('<html><head><title>"+W.title.replace(/\'/g,"\\'")+"</title><script>var "+S+' = "'+encodeURIComponent(s()).replace(/\'/g,"\\'")+(W.domain!=z.hostname?'";document.domain="'+W.domain:"")+"\";<\/script></head></html>');document.close();";O<7?g.src=t:g.contentWindow.location.replace(t)},S="jQueryAddress",I="hashchange",U="init",j="change",R="internalChange",N={autoUpdate:A=!(E=null),history:A,strict:A,frames:A,wrap:q=!(T="externalChange")},$={},(v=function(t){t=t.toLowerCase();t=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:t[1]||"",version:t[2]||"0"}}(navigator.userAgent)).browser&&($[v.browser]=!0,$.version=v.version),$.chrome?$.webkit=!0:$.webkit&&($.safari=!0),$=$,O=parseFloat($.version),L=$.webkit||$.safari,C=$.msie,M=o(),W=M.document,_=M.history,z=M.location,B=setInterval,P=setTimeout,Q=/\/{2,9}/g,$=navigator.userAgent,D="on"+I in M,K=p("script:last").attr("src"),F=K?K.indexOf("?"):-1,G=W.title,V=A,X=J=H=q,Y=s(),C&&(O=parseFloat($.substr($.indexOf("MSIE")+4)),W.documentMode&&W.documentMode!=O&&(O=8!=W.documentMode?7:8),m=W.onpropertychange,W.onpropertychange=function(){m&&m.call(W),W.title!=G&&-1!=W.title.indexOf("#"+s())&&(W.title=G)}),_.navigationMode&&(_.navigationMode="compatible"),"complete"==document.readyState?y=setInterval(function(){p.address&&(t(),clearInterval(y))},50):(h(),p(t)),p(window).on("popstate",function(){decodeURI(Y)!=decodeURI(s())&&(Y=s(),b(q))}).on("unload",function(){M.removeEventListener?M.removeEventListener(I,l,q):M.detachEvent&&M.detachEvent("on"+I,l)}),{bind:function(t,e,r){return a.apply(this,n(arguments))},unbind:function(t,e){return function(t,e){return p().off.apply(p(p.address),Array.prototype.slice.call(arguments)),p.address}.apply(this,n(arguments))},init:function(t,e){return a.apply(this,[U].concat(n(arguments)))},change:function(t,e){return a.apply(this,[j].concat(n(arguments)))},internalChange:function(t,e){return a.apply(this,[R].concat(n(arguments)))},externalChange:function(t,e){return a.apply(this,[T].concat(n(arguments)))},baseURL:function(){var t=z.href;return-1!=t.indexOf("#")&&(t=t.substr(0,t.indexOf("#"))),/\/$/.test(t)&&(t=t.substr(0,t.length-1)),t},autoUpdate:function(t){return t!==f?(N.autoUpdate=t,this):N.autoUpdate},history:function(t){return t!==f?(N.history=t,this):N.history},state:function(t){if(t===f)return N.state;N.state=t;var e=i();return N.state!==f&&(_.pushState?"/#/"==e.substr(0,3)&&z.replace(N.state.replace(/^\/$/,"")+e.substr(2)):"/"!=e&&e.replace(/^\/#/,"")!=w()&&P(function(){z.replace(N.state.replace(/^\/$/,"")+"/#"+e)},1)),this},frames:function(t){return t!==f?(N.frames=t,M=o(),this):N.frames},strict:function(t){return t!==f?(N.strict=t,this):N.strict},tracker:function(t){return t!==f?(N.tracker=t,this):N.tracker},wrap:function(t){return t!==f?(N.wrap=t,this):N.wrap},update:function(){return X=A,this.value(Y),X=q,this},title:function(t){return t!==f?(P(function(){G=W.title=t,V&&g&&g.contentWindow&&g.contentWindow.document&&(g.contentWindow.document.title=t,V=q)},50),this):W.title},value:function(t){if(t===f)return u(Y);if("/"==(t=u(t))&&(t=""),Y!=t||X){if(Y=t,N.autoUpdate||X){if(b(A))return this;r()?_[N.history?"pushState":"replaceState"]({},"",N.state.replace(/\/$/,"")+(""===Y?"/":Y)):(H=A,!L&&Y==s()||(N.history?z.hash="#"+Y:z.replace("#"+Y)),C&&!D&&N.history&&P(k,50),L?P(function(){H=q},1):H=q)}return this}},path:function(t){if(t===f)return u(Y).split("#")[0].split("?")[0];var e=this.queryString(),r=this.hash();return this.value(t+(e?"?"+e:"")+(r?"#"+r:"")),this},pathNames:function(){var t=this.path(),e=t.replace(Q,"/").split("/");return"/"!=t.substr(0,1)&&0!==t.length||e.splice(0,1),"/"==t.substr(t.length-1,1)&&e.splice(e.length-1,1),e},queryString:function(t){if(t!==f){var e=this.hash();return this.value(this.path()+(t?"?"+t:"")+(e?"#"+e:"")),this}e=Y.split("?");return e.slice(1,e.length).join("?").split("#")[0]},parameter:function(t,e,r){var n;if(e!==f){var a=this.parameterNames(),i=[];for(e=e===f||e===E?"":e.toString(),n=0;n<a.length;n++){var s=a[n],o=this.parameter(s);"string"==typeof o&&(o=[o]),s==t&&(o=e===E||""===e?[]:r?o.concat([e]):[e]);for(var c=0;c<o.length;c++)i.push(s+"="+o[c])}return-1==p.inArray(t,a)&&e!==E&&""!==e&&i.push(t+"="+e),this.queryString(i.join("&")),this}if(e=this.queryString()){var u=[];for(i=e.split("&"),n=0;n<i.length;n++){var d=i[n].split("=");d[0]==t&&u.push(d.slice(1).join("="))}if(0!==u.length)return 1!=u.length?u:u[0]}},parameterNames:function(){var t=this.queryString(),e=[];if(t&&-1!=t.indexOf("="))for(var r=t.split("&"),n=0;n<r.length;n++){var a=r[n].split("=")[0];-1==p.inArray(a,e)&&e.push(a)}return e},hash:function(t){if(t!==f)return this.value(Y.split("#")[0]+(t?"#"+t:"")),this;t=Y.split("#");return t.slice(1,t.length).join("#")}}),p.fn.address=function(r){return p(this).each(function(t){p(this).data("address")||p(this).on("click",function(t){if(t.shiftKey||t.ctrlKey||t.metaKey||2==t.which)return!0;var e=t.currentTarget;p(e).is("a")&&(t.preventDefault(),e=r?r.call(e):/address:/.test(p(e).attr("rel"))?p(e).attr("rel").split("address:")[1].split(" ")[0]:void 0===p.address.state()||/^\/?$/.test(p.address.state())?p(e).attr("href").replace(/^(#\!?|\.)/,""):p(e).attr("href").replace(new RegExp("^(.*"+p.address.state()+"|\\.)"),""),p.address.value(e))}).on("submit",function(t){var e=t.currentTarget;p(e).is("form")&&(t.preventDefault(),t=p(e).attr("action"),e=r?r.call(e):(-1!=t.indexOf("?")?t.replace(/&$/,""):t+"?")+p(e).serialize(),p.address.value(e))}).data("address",!0)}),this}}(jQuery);
